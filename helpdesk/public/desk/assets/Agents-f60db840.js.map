{"version":3,"file":"Agents-f60db840.js","sources":["../../../../desk/src/components/desk/global/AddNewAgentsDialog.vue","../../../../desk/src/pages/desk/agent/Agents.vue"],"sourcesContent":["<template>\n  <div>\n    <Dialog :options=\"{ title: 'Add Agents' }\" :show=\"show\" @close=\"close()\">\n      <template #body-content>\n        <div class=\"space-y-3\">\n          <form\n            @submit.prevent=\"onSubmit\"\n            class=\"flex flex-row items-center space-x-2\"\n          >\n            <Input\n              id=\"searchInput\"\n              class=\"w-full\"\n              type=\"text\"\n              v-model=\"searchInput\"\n              placeholder=\"Type emails\"\n              @input=\"(val) => onSearchInputChange(val)\"\n            />\n            <Button\n              appearance=\"primary\"\n              type=\"submit\"\n              :disabled=\"!currentInputIsValidEmail\"\n              @click=\"\n                () => {\n                  addToInviteQueue(searchInput);\n                  clearSearchInput();\n                }\n              \"\n            >\n              Add\n            </Button>\n          </form>\n          <div\n            class=\"flex max-h-[300px] min-h-[100px] flex-col overflow-y-auto rounded border bg-gray-100 px-2\"\n            v-if=\"inviteQueue.length\"\n          >\n            <ul class=\"flex flex-wrap gap-2 py-2\">\n              <li\n                class=\"flex items-center space-x-2 rounded bg-white p-1 shadow\"\n                v-for=\"email in inviteQueue.slice().reverse()\"\n                :key=\"email\"\n                :title=\"email\"\n              >\n                <span class=\"ml-2 text-base\">\n                  {{ email }}\n                </span>\n                <button\n                  class=\"grid h-4 w-4 place-items-center rounded text-gray-700 hover:bg-gray-300\"\n                  @click=\"removeEmailFromQueue(email)\"\n                >\n                  <FeatherIcon class=\"w-3\" name=\"x\" />\n                </button>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </template>\n      <template #actions v-if=\"inviteQueue.length\">\n        <Button\n          :disabled=\"inviteQueue.length == 0\"\n          appearance=\"primary\"\n          @click=\"sentInvites()\"\n          class=\"mr-2\"\n          :loading=\"$resources.sentInvites.loading\"\n          >Send Invites</Button\n        >\n        <Button appearance=\"secondary\" class=\"mr-2\" @click=\"close()\"\n          >Cancel</Button\n        >\n        <div class=\"grow mt-2\">\n          <Button\n            @click=\"removeAllEmailFromQueue()\"\n            v-if=\"inviteQueue.length > 1\"\n          >\n            Clear All\n          </Button>\n        </div>\n      </template>\n    </Dialog>\n  </div>\n</template>\n\n<script>\nimport { Dialog, Input, FeatherIcon } from \"frappe-ui\";\nimport { ref } from \"@vue/reactivity\";\n\nexport default {\n  name: \"AddNewAgentsDialog\",\n  props: [\"show\"],\n  components: {\n    Dialog,\n    Input,\n    FeatherIcon,\n  },\n  setup() {\n    const searchInput = ref(\"\");\n    const inviteQueue = ref([]);\n\n    const currentInputIsValidEmail = ref(false);\n\n    return {\n      searchInput,\n      inviteQueue,\n      currentInputIsValidEmail,\n    };\n  },\n  methods: {\n    testEmailRegex(val) {\n      let emailRegex = /^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$/;\n      return emailRegex.test(val);\n    },\n    onSearchInputChange(val) {\n      val = val.replaceAll(\" \", \"\");\n\n      if (val == \"\") {\n        document.getElementById(\"searchInput\").value = \"\";\n        return;\n      }\n\n      const valStr = val;\n      const inputs = val.split(\",\");\n\n      let clearInputFlag = false;\n      this.currentInputIsValidEmail = false;\n      inputs.forEach((input) => {\n        if (this.testEmailRegex(input)) {\n          if (inputs.length > 1) {\n            this.addToInviteQueue(input);\n            clearInputFlag = true;\n          } else {\n            if (valStr.includes(\",\")) {\n              this.addToInviteQueue(input);\n              clearInputFlag = true;\n            } else {\n              this.currentInputIsValidEmail = true;\n            }\n          }\n        }\n      });\n      if (clearInputFlag) {\n        this.clearSearchInput();\n      }\n    },\n    addToInviteQueue(email) {\n      this.inviteQueue = [...new Set([...this.inviteQueue, email])];\n    },\n    removeEmailFromQueue(email) {\n      this.inviteQueue = this.inviteQueue.filter((item) => item !== email);\n    },\n    removeAllEmailFromQueue() {\n      this.inviteQueue = [];\n    },\n    clearSearchInput() {\n      this.currentInputIsValidEmail = false;\n      this.searchInput = \"\";\n\n      const input = document.getElementById(\"searchInput\");\n      input.value = \"\";\n      input.focus();\n    },\n    close() {\n      this.searchInput = \"\";\n      this.inviteQueue = [];\n      this.$emit(\"close\");\n    },\n    sentInvites() {\n      this.$resources.sentInvites.submit({\n        emails: this.inviteQueue,\n      });\n    },\n  },\n  resources: {\n    sentInvites() {\n      return {\n        url: \"helpdesk.api.agent.sent_invites\",\n        onSuccess: (res) => {\n          this.currentInputIsValidEmail = false;\n          this.searchInput = \"\";\n          this.inviteQueue = [];\n\n          this.$toast({\n            title: \"Invites Sent Successfully!\",\n            icon: \"check\",\n            iconClasses: \"text-green-500\",\n          });\n\n          this.close();\n        },\n      };\n    },\n  },\n};\n</script>\n","<template>\n  <div class=\"flex flex-col\">\n    <LayoutHeader>\n      <template #left-header>\n        <div class=\"text-lg font-medium text-gray-900\">Agents</div>\n      </template>\n      <template #right-header>\n        <Button\n          label=\"New agent\"\n          theme=\"gray\"\n          variant=\"solid\"\n          @click=\"isDialogVisible = !isDialogVisible\"\n        >\n          <template #prefix>\n            <LucidePlus class=\"h-4 w-4\" />\n          </template>\n        </Button>\n      </template>\n    </LayoutHeader>\n\n    <ListViewBuilder\n      :options=\"options\"\n      @empty-state-action=\"isDialogVisible = true\"\n    />\n    <AddNewAgentsDialog\n      :show=\"isDialogVisible\"\n      @close=\"isDialogVisible = false\"\n    />\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { computed, ref, h } from \"vue\";\nimport { usePageMeta, Avatar } from \"frappe-ui\";\nimport AddNewAgentsDialog from \"@/components/desk/global/AddNewAgentsDialog.vue\";\nimport { LayoutHeader, ListViewBuilder } from \"@/components\";\n\nconst isDialogVisible = ref(false);\n\n// filter not on first field/ datetime\n// options mei route or click ka option\nconst options = computed(() => {\n  return {\n    doctype: \"HD Agent\",\n    defaultFilters: { is_active: [\"=\", 1] },\n    columnConfig: {\n      agent_name: {\n        prefix: ({ row }) => {\n          return h(Avatar, {\n            shape: \"circle\",\n            image: row.user_image,\n            label: row.agent_name,\n            size: \"sm\",\n          });\n        },\n      },\n    },\n    emptyState: {\n      title: \"No Agents Found\",\n    },\n  };\n});\n\nusePageMeta(() => {\n  return {\n    title: \"Agents\",\n  };\n});\n</script>\n"],"names":["_sfc_main","Dialog","Input","FeatherIcon","searchInput","ref","inviteQueue","currentInputIsValidEmail","val","valStr","inputs","clearInputFlag","input","email","item","res","_hoisted_1","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_createElementBlock","_createVNode","_component_Dialog","$props","$options","_createSlots","_createElementVNode","_cache","_withModifiers","_ctx","args","_component_Input","$setup","$event","_component_Button","_withCtx","_createTextVNode","_openBlock","_hoisted_2","_Fragment","_renderList","_toDisplayString","_component_FeatherIcon","_createCommentVNode","_createBlock","isDialogVisible","options","computed","row","h","Avatar","usePageMeta"],"mappings":"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"}