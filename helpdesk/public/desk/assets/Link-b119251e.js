import{B as N,aW as Q,aU as X,e as C,ab as U,aG as Y,o as i,f as I,w as f,g as v,h as u,P as ee,E as _,F as O,G as D,l as g,x as A,k as c,t as V,W as E,a0 as G,aL as te,aM as ae,H,I as R,y as j,aN as se,aa as W,s as le,a1 as K,aO as re,aK as Z,Z as oe,r as J,ae as ue}from"./index-7cfac70d.js";const ne={class:"w-full"},ie=["onClick"],de={class:"flex items-center"},ce={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},fe={key:1,class:"text-base leading-5 text-gray-500"},pe={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},me={class:"relative px-1.5 pt-0.5"},ge={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},ye={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},he={key:0,class:"border-t p-1.5 pb-0.5"},ve={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup(B,{expose:q,emit:s}){const r=B,d=s,p=N(""),b=N(!1),S=N(null),w=Q(),y=X(),L=C(()=>"value"in w),k=C({get(){return L.value?w.value:r.modelValue},set(e){p.value="",e&&(b.value=!1),d(L.value?"change":"update:modelValue",e)}});function M(){b.value=!1}const t=C(()=>{var a;return!r.options||r.options.length==0?[]:((a=r.options[0])!=null&&a.group?r.options:[{group:"",items:r.options}]).map((o,n)=>({key:n,group:o.group,hideLabel:o.hideLabel||!1,items:r.filterable?h(o.items):o.items})).filter(o=>o.items.length>0)});function h(e){return p.value?e.filter(a=>[a.label,a.value].some(n=>(n||"").toString().toLowerCase().includes(p.value.toLowerCase()))):e}function l(e){if(typeof e=="string"){let o=t.value.flatMap(n=>n.items).find(n=>n.value===e);return(o==null?void 0:o.label)||e}return e==null?void 0:e.label}U(p,e=>{d("update:query",e)}),U(b,e=>{e&&Y(()=>{S.value.el.focus()})});const $=C(()=>r.disabled?"text-gray-600":"text-gray-800"),m=C(()=>{let e={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[r.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[r.size],o=r.disabled?"disabled":r.variant,n={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",r.variant==="outline"?"border-gray-300":"border-transparent"]}[o];return[e,a,n,$.value,"transition-colors w-full"]});return q({query:p}),(e,a)=>(i(),I(u(re),{modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=o=>k.value=o),nullable:""},{default:f(({open:o})=>[v(u(ee),{class:"w-full",show:b.value,"onUpdate:show":a[2]||(a[2]=n=>b.value=n)},{target:f(({open:n,togglePopover:z})=>[_(e.$slots,"target",O(D({open:n,togglePopover:z,isOpen:b.value,selectedValue:k.value,displayValue:l})),()=>[g("div",ne,[g("button",{class:A(["flex w-full items-center justify-between focus:outline-none",m.value]),onClick:()=>z()},[g("div",de,[_(e.$slots,"prefix"),k.value?(i(),c("span",ce,V(l(k.value)),1)):(i(),c("span",fe,V(B.placeholder||""),1))]),v(u(E),{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,ie)])])]),body:f(({isOpen:n})=>{var z;return[G(g("div",null,[g("div",pe,[g("div",me,[v(u(te),{ref_key:"search",ref:S,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=x=>{p.value=x.target.value}),value:p.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),g("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=x=>k.value=null)},[v(u(E),{name:"x",class:"w-4"})])]),v(u(ae),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:f(()=>[(i(!0),c(H,null,R(t.value,x=>G((i(),c("div",{class:"mt-1.5",key:x.key},[x.group&&!x.hideLabel?(i(),c("div",ge,V(x.group),1)):j("",!0),(i(!0),c(H,null,R(x.items,P=>(i(),I(u(se),{as:"template",key:P.value,value:P},{default:f(({active:T,selected:F})=>[g("li",{class:A(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":T}])},[_(e.$slots,"item-prefix",W({ref_for:!0},{active:T,selected:F,option:P})),_(e.$slots,"item-label",W({ref_for:!0},{active:T,selected:F,option:P}),()=>[le(V(P.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[K,x.items.length>0]])),128)),t.value.length==0?(i(),c("li",ye," No results found ")):j("",!0)]),_:3}),u(y).footer?(i(),c("div",he,[_(e.$slots,"footer",O(D({value:(z=S.value)==null?void 0:z.el._value,close:M})))])):j("",!0)])],512),[[K,n]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},be={class:"space-y-1.5"},xe={key:0,class:"flex flex-col gap-1"},_e={class:"flex-1 font-semibold truncate text-ink-gray-7"},we={class:"flex-1 text-sm truncate text-ink-gray-5"},ke={key:1,class:"flex-1 truncate text-ink-gray-7"},Ce={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:null},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1},pageLength:{type:Number,default:10},hideClearButton:{type:Boolean,default:!1},showDescription:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(B,{emit:q}){const s=B,r=q,d=Q(),p=C(()=>"value"in d),b=C({get:()=>p.value?d.value:s.modelValue,set:t=>(t==null?void 0:t.value)&&r(p.value?"change":"update:modelValue",t==null?void 0:t.value)}),S=N(null),w=N("");Z(()=>{var t;return(t=S.value)==null?void 0:t.query},t=>{t=t||"",w.value!==t&&(w.value=t,L(t))},{debounce:300,immediate:!0}),Z(()=>s.doctype,()=>L(""),{debounce:300,immediate:!0}),U(()=>s==null?void 0:s.filters,t=>{y.update({params:{txt:w.value,doctype:s.doctype,filters:t,page_length:s.pageLength}}),y.reload()},{deep:!0});const y=oe({url:"frappe.desk.search.search_link",cache:[s.doctype,w.value,s.hideMe],method:"POST",params:{txt:w.value,doctype:s.doctype,filters:s.filters,page_length:s.pageLength},transform:t=>{let h=t.map(l=>({value:l.value,label:(l==null?void 0:l.label)||l.value,description:l==null?void 0:l.description}));return!s.hideMe&&(s.doctype=="User"||s.doctype=="HD Agent")&&h.unshift({label:"@me",value:"@me"}),h}});function L(t){var h,l,$;(h=y.data)!=null&&h.length&&t===((l=y.params)==null?void 0:l.txt)&&s.doctype===(($=y.params)==null?void 0:$.doctype)||(y.update({params:{txt:t,doctype:s.doctype,filters:s.filters,page_length:s.pageLength}}),y.reload())}function k(t){r(p.value?"change":"update:modelValue",""),t()}const M=C(()=>[{sm:"text-xs",md:"text-base"}[d.size||"sm"],"text-gray-600"]);return(t,h)=>{const l=J("FeatherIcon"),$=J("Button");return i(),c("div",be,[u(d).label?(i(),c("label",{key:0,class:A(["block",M.value])},V(u(d).label),3)):j("",!0),v(ve,{ref_key:"autocomplete",ref:S,options:u(y).data,modelValue:b.value,"onUpdate:modelValue":h[0]||(h[0]=m=>b.value=m),size:u(d).size||"sm",variant:u(d).variant,placeholder:u(d).placeholder,filterable:!1},ue({target:f(({open:m,togglePopover:e})=>[_(t.$slots,"target",O(D({open:m,togglePopover:e})))]),prefix:f(()=>[_(t.$slots,"prefix")]),"item-prefix":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-prefix",O(D({active:m,selected:e,option:a})))]),"item-label":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-label",O(D({active:m,selected:e,option:a})),()=>[a.description&&B.showDescription?(i(),c("div",xe,[g("div",_e,V(a.label),1),g("div",we,V(a.description),1)])):(i(),c("div",ke,V(a.label),1))])]),_:2},[B.hideClearButton?void 0:{name:"footer",fn:f(({value:m,close:e})=>[u(d).onCreate?(i(),c("div",Ce,[v($,{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:a=>u(d).onCreate(m,e)},{prefix:f(()=>[v(l,{name:"plus",class:"h-4"})]),_:2},1032,["onClick"])])):j("",!0),g("div",null,[v($,{variant:"ghost",class:"w-full !justify-start",label:"Clear",onClick:()=>k(e)},{prefix:f(()=>[v(l,{name:"x",class:"h-4"})]),_:2},1032,["onClick"])])]),key:"0"}]),1032,["options","modelValue","size","variant","placeholder"])])}}};export{$e as _,ve as a};
//# sourceMappingURL=Link-b119251e.js.map
