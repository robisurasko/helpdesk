import{d as M,B as b,al as be,r as Q,h as n,o as a,k as l,l as e,g as u,w as S,H as L,I as R,f as I,t as w,y as C,bv as te,j as ae,O as ke,Z as P,x as H,a0 as ye,dk as xe,p as T,aH as Ee,e as V,W as we,s as q,a2 as K,ac as N,dJ as Ie,V as Z,ap as Be,U as X,a as Qe,n as $e,v as W,J as Se,c as Le,q as De,b as Ve,u as Re,dK as Fe,dL as Me,M as J,C as Ue,E as Pe}from"./index-adf298f8.js";import{_ as Je,u as Ze,c as Ne,j as Oe,C as je}from"./useView-5b009477.js";import{a as He}from"./more-horizontal-20f1eb21.js";import{d as Te}from"./dayjs-60adf9f1.js";import{u as ne,c as qe,a as ze,_ as Ge,b as We,d as G,e as Ye}from"./layoutSettings-25288562.js";import{u as oe,L as Ke}from"./bell-90f80f9a.js";import{_ as Xe}from"./UserAvatar.vue_vue_type_script_setup_true_lang-f6992848.js";import"./knowledgeBase-b1232fe2.js";import{_ as et}from"./plus-f971c398.js";import{_ as tt}from"./Avatar.vue_vue_type_script_setup_true_lang-53016530.js";import{F as at}from"./FileUploader-310a50a0.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-897a4f2b.js";const nt={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5"},ot={class:"divide-y text-base"},lt={class:"mb-2 leading-5"},st={class:"space-x-1 text-gray-700"},it={class:"font-medium text-gray-900"},ct={key:0},rt={key:1},ut={key:2},dt={class:"font-medium text-gray-900"},mt={class:"flex items-center gap-2"},pt={class:"text-sm text-gray-600"},gt={key:0,class:"h-1.5 w-1.5 rounded-full bg-blue-400"},_t=M({__name:"Notifications",setup(p){const t=oe(),s=ne(),i=b(null);be(i,()=>{t.visible&&t.toggle()},{ignore:["#notifications-btn"]});function o(r){t.toggle(),!r.read&&t.read(r.reference_ticket)}function c(r){switch(r.notification_type){case"Mention":return{name:"TicketAgent",params:{ticketId:r.reference_ticket},hash:"#"+r.reference_comment};case"Assignment":case"Reaction":return{name:"TicketAgent",params:{ticketId:r.reference_ticket}}}}return(r,f)=>{const h=Je,d=Q("Button"),y=He,_=Q("RouterLink");return n(t).visible?(a(),l("span",{key:0,ref_key:"target",ref:i,class:"fixed z-10 h-screen overflow-auto bg-white",style:te({"box-shadow":"8px 0px 8px rgba(0, 0, 0, 0.1)","max-width":"350px","min-width":"350px",left:n(s).width})},[e("div",nt,[f[2]||(f[2]=e("span",{class:"text-lg font-medium"},"Notifications",-1)),e("span",null,[u(d,{theme:"blue",variant:"ghost",onClick:f[0]||(f[0]=()=>n(t).clear.submit())},{icon:S(()=>[u(h,{class:"h-4 w-4"})]),_:1}),u(d,{theme:"gray",variant:"ghost",onClick:f[1]||(f[1]=()=>n(t).toggle())},{icon:S(()=>[u(y,{class:"h-4 w-4"})]),_:1})])]),e("div",ot,[(a(!0),l(L,null,R(n(t).data,v=>(a(),I(_,{key:v.name,class:"flex cursor-pointer items-start gap-3.5 px-5 py-2.5 hover:bg-gray-100",to:c(v),onClick:()=>{o(v)}},{default:S(()=>[u(n(Xe),{name:v.user_from},null,8,["name"]),e("span",null,[e("div",lt,[e("span",st,[e("span",it,w(v.user_from),1),v.notification_type==="Mention"?(a(),l("span",ct,"mentioned you in ticket")):C("",!0),v.notification_type==="Assignment"?(a(),l("span",rt,"assigned you a ticket")):C("",!0),v.notification_type==="Reaction"?(a(),l("span",ut,"has reopened the ticket")):C("",!0),e("span",dt,w(v.reference_ticket),1)])]),e("div",mt,[e("div",pt,w(n(Te).tz(v.creation).fromNow()),1),v.read?C("",!0):(a(),l("div",gt))])])]),_:2},1032,["to","onClick"]))),128))])],4)):C("",!0)}}});const At={class:"border-b"},ft={id:"app-header",class:"w-full flex items-center justify-center px-2 py-1"},ht={class:"flex items-center gap-2"},vt={class:"flex items-center gap-1"},Ct={class:"relative"},bt={__name:"AppHeader",setup(p){const t=b("Online"),s=b(""),i=b("");ke(()=>{P({url:"frappe.auth.get_logged_user"}).submit().then(c=>{s.value=c,P({url:"frappe.client.get_list",params:{doctype:"HD Agent",fields:["name","custom_current_status"],filters:{name:c},limit:1}}).submit().then(r=>{r&&r.length>0&&(i.value=r[0].name,t.value=r[0].custom_current_status||"Offline")})})});function o(){i.value&&P({url:"frappe.client.set_value",params:{doctype:"HD Agent",name:i.value,fieldname:"custom_current_status",value:t.value}}).submit()}return(c,r)=>(a(),l("div",At,[e("div",ft,[e("div",ht,[r[3]||(r[3]=e("span",{class:"text-xs text-gray-600"},"My Status",-1)),e("div",vt,[e("div",{class:H(["w-2 h-2 rounded-full",{"bg-green-500":t.value==="Online","bg-yellow-500":t.value==="Busy","bg-red-500":t.value==="Offline"}])},null,2),e("div",Ct,[ye(e("select",{"onUpdate:modelValue":r[0]||(r[0]=f=>t.value=f),class:"appearance-none bg-gray-100 border border-gray-300 rounded text-xs px-1.5 py-0.5 pr-5 focus:outline-none focus:ring-1 focus:ring-blue-500 h-[1.25rem]",onChange:o},r[1]||(r[1]=[e("option",{value:"Online"},"Online",-1),e("option",{value:"Busy"},"Busy",-1),e("option",{value:"Offline"},"Offline",-1)]),544),[[xe,t.value]]),r[2]||(r[2]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-1 text-gray-500"},[e("svg",{class:"fill-current h-2.5 w-2.5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1))])])])])]))}},kt=ae(bt,[["__scopeId","data-v-52d3df97"]]);b(!1);b(!1);T({});Ee("onboardingStatus",{});b(!1);const yt={},xt={width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Et(p,t){return a(),l("svg",xt,t[0]||(t[0]=[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.2641 1C5.5758 1 4.97583 1.46845 4.80889 2.1362L3.57555 7.06953C3.33887 8.01625 4.05491 8.93333 5.03077 8.93333H7.50682L6.72168 14.4293C6.68838 14.6624 6.82229 14.8872 7.04319 14.9689C7.26408 15.0507 7.51204 14.9671 7.63849 14.7684L13.2161 6.00354C13.6398 5.33782 13.1616 4.46667 12.3725 4.46667H9.59038L10.3017 1.62127C10.3391 1.4719 10.3055 1.31365 10.2108 1.19229C10.116 1.07094 9.97063 1 9.81666 1H6.2641ZM5.77903 2.37873C5.83468 2.15615 6.03467 2 6.2641 2H9.17627L8.46492 4.8454C8.42758 4.99477 8.46114 5.15302 8.55589 5.27437C8.65064 5.39573 8.79602 5.46667 8.94999 5.46667H12.3725L8.0395 12.2757L8.5783 8.50404C8.5988 8.36056 8.55602 8.21523 8.46105 8.10573C8.36608 7.99623 8.22827 7.93333 8.08332 7.93333H5.03077C4.70548 7.93333 4.4668 7.62764 4.5457 7.31207L5.77903 2.37873Z",fill:"currentColor"},null,-1)]))}const ee=ae(yt,[["render",Et]]),wt={key:0,class:"flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base"},It={class:"flex flex-col gap-1"},Bt={class:"inline-flex text-ink-gray-9 gap-2 items-center font-medium"},Qt="Upgrade to a paid plan for uninterrupted services",$t={__name:"TrialBanner",props:{isSidebarCollapsed:{type:Boolean,default:!1},afterUpgrade:{type:Function,default:()=>{}}},setup(p){const t=p,s=b(0),i=b(!1),o=b("https://frappecloud.com"),c=b(""),r=V(()=>s.value>1?"Trial ends in "+s.value+" days":"Trial ends tomorrow");P({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"current_site_info_data",auto:!0,onSuccess:d=>{s.value=f(d.trial_end_date),o.value=d.base_url,c.value=d.site_name,i.value=d.setup_complete&&d.plan.is_trial_plan&&s.value>0}});function f(d){if(!d)return 0;d=new Date(d);const _=d-new Date;return Math.ceil(_/(1e3*60*60*24))}function h(){var d;window.open(`${o.value}/dashboard/sites/${c.value}`,"_blank"),(d=t.afterUpgrade)==null||d.call(t)}return(d,y)=>!p.isSidebarCollapsed&&i.value?(a(),l("div",wt,[e("div",It,[e("div",Bt,[u(we,{class:"h-4",name:"info"}),q(" "+w(r.value),1)]),e("div",{class:"text-ink-gray-7 text-p-sm"},w(Qt))]),u(n(K),{label:"Upgrade plan",theme:"blue",onClick:h},{prefix:S(()=>[u(ee,{class:"size-4"})]),_:1})])):p.isSidebarCollapsed&&i.value?(a(),I(n(K),{key:1,onClick:h},{default:S(()=>[u(ee,{class:"h-4 my-0.5 shrink-0"})]),_:1})):C("",!0)}},St={class:"lucide lucide-arrow-left-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Lt(p,t){return a(),l("svg",St,t[0]||(t[0]=[e("path",{d:"m9 6-6 6 6 6"},null,-1),e("path",{d:"M3 12h14"},null,-1),e("path",{d:"M21 19V5"},null,-1)]))}const Dt=N({name:"lucide-arrow-left-from-line",render:Lt}),Vt={class:"lucide lucide-arrow-right-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Rt(p,t){return a(),l("svg",Vt,t[0]||(t[0]=[e("path",{d:"M3 5v14"},null,-1),e("path",{d:"M21 12H7"},null,-1),e("path",{d:"m15 18 6-6-6-6"},null,-1)]))}const Ft=N({name:"lucide-arrow-right-from-line",render:Rt}),Mt={class:"lucide lucide-mail",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Ut(p,t){return a(),l("svg",Mt,t[0]||(t[0]=[e("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"},null,-1),e("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"},null,-1)]))}const Pt=N({name:"lucide-mail",render:Ut}),Jt={class:"lucide lucide-image-up",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Zt(p,t){return a(),l("svg",Jt,t[0]||(t[0]=[e("path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"},null,-1),e("path",{d:"m14 19.5 3-3 3 3"},null,-1),e("path",{d:"M17 22v-5.5"},null,-1),e("circle",{cx:"9",cy:"9",r:"2"},null,-1)]))}const Nt=N({name:"lucide-image-up",render:Zt}),Ot={class:"lucide lucide-circle-alert",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function jt(p,t){return a(),l("svg",Ot,t[0]||(t[0]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"12",x2:"12",y1:"8",y2:"12"},null,-1),e("line",{x1:"12",x2:"12.01",y1:"16",y2:"16"},null,-1)]))}const le=N({name:"lucide-circle-alert",render:jt}),se="/assets/helpdesk/desk/assets/gmail-6497f877.png",ie="/assets/helpdesk/desk/assets/outlook-e028ee9b.png",ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwMAAALUBAMAAAClQPMzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAACRQTFRFR3BMNqzpdMXvXb3tr+f3o+P1AJ/ZGoPjALPjmeH1dc3uBqfjM5e/jQAAAAZ0Uk5TAPVwwVLTgnc47wAABIBJREFUeNrt1rEJwlAYhdEHNpZa2UpwAxewcAXtbdJYpQo4gATsBVdwAOcTd/DyknC+9zY4XPhLkSRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJGmGL/cTazo5gOWR69KFWCBAgQIAAAQIECBAgmArBHYEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAMHfO4U6X9tP4reb9aX77/v9rqtH8Ar1bEOl1oWgNsGAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAjqEfShbu9QTajD/AhS8yqzCwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIKheE2p3DFUkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZLG2Bet4fvU2eVggAAAAABJRU5ErkJggg==",re="/assets/helpdesk/desk/assets/sparkpost-3d6653ba.webp",ue="/assets/helpdesk/desk/assets/yahoo-bf2216d3.png",de="/assets/helpdesk/desk/assets/yandex-5e1e6be8.png",me="/assets/helpdesk/desk/assets/frappe-mail-579163d7.svg",pe=[{label:"Account Name",name:"email_account_name",type:"text",placeholder:"Support / Sales"},{label:"Email ID",name:"email_id",type:"email",placeholder:"johndoe@example.com"}],ge=[{label:"Enable Incoming",name:"enable_incoming",type:"checkbox",description:"If enabled, tickets can be created from the incoming emails on this account."},{label:"Enable Outgoing",name:"enable_outgoing",type:"checkbox",description:"If enabled, outgoing emails can be sent from this account."},{label:"Default Incoming",name:"default_incoming",type:"checkbox",description:"If enabled, all replies to your company (eg: replies@yourcomany.com) will come to this account. Note: Only one account can be default incoming."},{label:"Default Outgoing",name:"default_outgoing",type:"checkbox",description:"If enabled, all outgoing emails will be sent from this account. Note: Only one account can be default outgoing."}],_e=[...pe,{label:"Password",name:"password",type:"password",placeholder:"********"}],Ae=[...pe,{label:"Frappe Mail Site",name:"frappe_mail_site",type:"text",placeholder:"https://frappemail.com"},{label:"API Key",name:"api_key",type:"text",placeholder:"********"},{label:"API Secret",name:"api_secret",type:"password",placeholder:"********"}],fe=[{name:"GMail",icon:se,info:`Setting up GMail requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.google.com/accounts/answer/185833",custom:!1},{name:"Outlook",icon:ie,info:`Setting up Outlook requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.microsoft.com/en-us/account-billing/how-to-get-and-use-app-passwords-5896ed9b-4263-e681-128a-a6f2979a7944",custom:!1},{name:"Sendgrid",icon:ce,info:`Setting up Sendgrid requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://sendgrid.com/docs/ui/account-and-settings/two-factor-authentication/",custom:!1},{name:"SparkPost",icon:re,info:`Setting up SparkPost requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://support.sparkpost.com/docs/my-account-and-profile/enabling-two-factor-authentication",custom:!1},{name:"Yahoo",icon:ue,info:`Setting up Yahoo requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://help.yahoo.com/kb/SLN15241.html",custom:!1},{name:"Yandex",icon:de,info:`Setting up Yandex requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://yandex.com/support/id/authorization/app-passwords.html",custom:!1},{name:"Frappe Mail",icon:me,info:"Setting up Frappe Mail requires you to have an API key and API Secret of your email account. Read more ",link:"https://github.com/frappe/mail",custom:!0}],he={GMail:se,Outlook:ie,Sendgrid:ce,SparkPost:re,Yahoo:ue,Yandex:de,"Frappe Mail":me};function ve(p,t){if(!p.email_account_name)return"Account name is required";if(!p.email_id)return"Email ID is required";if(!Ie(p.email_id))return"Invalid email ID";if(!t&&!p.password)return"Password is required";if(t){if(!p.api_key)return"API Key is required";if(!p.api_secret)return}return""}const Ht=["src"],Tt={key:0,class:"text-center text-xs text-gray-700"},Y=M({__name:"EmailProviderIcon",props:{serviceName:{default:""},logo:{default:""},selected:{type:Boolean,default:!1}},setup(p){return(t,s)=>(a(),l(L,null,[e("div",{class:H(["flex h-10 w-10 cursor-pointer items-center justify-center rounded-xl bg-gray-100 hover:bg-gray-200",{"ring-2 ring-blue-500":t.selected}])},[e("img",{src:t.logo,class:"h-6 w-6"},null,8,Ht)],2),t.serviceName?(a(),l("p",Tt,w(t.serviceName),1)):C("",!0)],64))}}),qt={class:"flex h-full flex-col gap-4"},zt={class:"flex flex-wrap items-center gap-4"},Gt=["onClick"],Wt={key:0,class:"flex flex-col gap-4"},Yt={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},Kt={class:"text-wrap text-xs text-gray-700"},Xt=["href"],ea={class:"flex flex-col gap-4"},ta={class:"grid grid-cols-1 gap-4"},aa={class:"grid grid-cols-2 gap-4"},na={class:"text-gray-500 text-p-sm"},oa={key:1,class:"mt-auto flex justify-between"},la=M({__name:"EmailAdd",emits:["update:step"],setup(p,{emit:t}){const s=t,i=T({service:"",email_account_name:"",email_id:"",password:"",api_key:"",api_secret:"",frappe_mail_site:"",enable_incoming:!1,enable_outgoing:!1,default_incoming:!1,default_outgoing:!1}),o=b(null),c=V(()=>o.value.custom?Ae:_e);function r(y){o.value=y,i.service=y.name}const f=P({url:"helpdesk.api.settings.create_email_account",makeParams:y=>({...y}),onSuccess:()=>{Z({title:"Email account created successfully",icon:"check",iconClasses:"text-green-600"}),s("update:step","email-list")},onError:()=>{h.value="Failed to create email account, Invalid credentials"}}),h=b();function d(){h.value=ve(i,o.value.custom),!h.value&&f.submit({data:i})}return(y,_)=>{const v=Q("FormControl"),D=Q("ErrorMessage"),k=Q("Button");return a(),l("div",qt,[_[2]||(_[2]=e("div",{role:"heading","aria-level":"1",class:"flex flex-col gap-1"},[e("h5",{class:"text-lg font-semibold"},"Setup Email"),e("p",{class:"text-sm text-gray-600"}," Choose the email service provider you want to configure. ")],-1)),e("div",zt,[(a(!0),l(L,null,R(n(fe),m=>{var $;return a(),l("div",{key:m.name,class:"min-w-3 mt-4 flex flex-col items-center gap-1",onClick:O=>r(m)},[u(Y,{"service-name":m.name,logo:m.icon,selected:(($=o.value)==null?void 0:$.name)===(m==null?void 0:m.name)},null,8,["service-name","logo","selected"])],8,Gt)}),128))]),o.value?(a(),l("div",Wt,[e("div",Yt,[u(n(le),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),e("div",Kt,[q(w(o.value.info)+" ",1),e("a",{href:o.value.link,target:"_blank",class:"text-blue-500 underline"},"here",8,Xt),_[1]||(_[1]=q(" . "))])]),e("div",ea,[e("div",ta,[(a(!0),l(L,null,R(c.value,m=>(a(),l("div",{key:m.name,class:"flex flex-col gap-1"},[u(v,{modelValue:i[m.name],"onUpdate:modelValue":$=>i[m.name]=$,label:m.label,name:m.name,type:m.type,placeholder:m.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),e("div",aa,[(a(!0),l(L,null,R(n(ge),m=>(a(),l("div",{key:m.name,class:"flex flex-col gap-1"},[u(v,{modelValue:i[m.name],"onUpdate:modelValue":$=>i[m.name]=$,label:m.label,name:m.name,type:m.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),e("p",na,w(m.description),1)]))),128))]),h.value?(a(),I(D,{key:0,class:"ml-1",message:h.value},null,8,["message"])):C("",!0)])])):C("",!0),o.value?(a(),l("div",oa,[u(k,{label:"Back",theme:"gray",variant:"outline",disabled:n(f).loading,onClick:_[0]||(_[0]=m=>s("update:step","email-list"))},null,8,["disabled"]),u(k,{label:"Create",variant:"solid",loading:n(f).loading,onClick:d},null,8,["loading"])])):C("",!0)])}}}),sa={class:"flex justify-between items-center border-b border-gray-200 p-2 cursor-pointer"},ia={class:"flex justify-between items-center gap-2"},ca={class:"text-gray-700 font-semibold"},ra={class:"text-sm text-gray-500"},ua=M({__name:"EmailAccountCard",props:{emailAccount:{}},setup(p){const t=p,s=V(()=>t.emailAccount.default_incoming&&t.emailAccount.default_outgoing?["Default Sending and Inbox",t.emailAccount.enable_incoming&&t.emailAccount.enable_outgoing?"blue":"gray"]:t.emailAccount.default_incoming?["Default Inbox",t.emailAccount.enable_incoming?"blue":"gray"]:t.emailAccount.default_outgoing?["Default Sending",t.emailAccount.enable_outgoing?"blue":"gray"]:["Inbox",t.emailAccount.enable_incoming?"blue":"gray"]);return(i,o)=>{const c=Q("Badge");return a(),l("div",sa,[e("div",ia,[u(Y,{logo:n(he)[i.emailAccount.service]},null,8,["logo"]),e("div",null,[e("p",ca,w(i.emailAccount.email_account_name),1),e("div",ra,w(i.emailAccount.email_id),1)])]),e("div",null,[u(c,{variant:"subtle",label:s.value[0],theme:s.value[1]},null,8,["label","theme"])])])}}}),da={class:"flex items-center justify-between"},ma={key:0,class:"mt-4"},pa={key:1,class:"flex items-center justify-center h-64 text-gray-500"},ga=M({__name:"EmailAccountList",emits:["update:step"],setup(p,{emit:t}){const s=t,i=Be({doctype:"Email Account",cache:!0,fields:["*"],filters:{email_id:["Not Like","%example%"]},pageLength:10,auto:!0,onSuccess:o=>{o.forEach(c=>{c.enable_incoming=!!c.enable_incoming,c.enable_outgoing=!!c.enable_outgoing,c.default_incoming=!!c.default_incoming,c.default_outgoing=!!c.default_outgoing})}});return(o,c)=>{var h;const r=et,f=Q("Button");return a(),l("div",null,[e("div",da,[c[1]||(c[1]=e("h1",{class:"text-lg font-semibold"},"Email Accounts",-1)),u(f,{label:"Add Account",theme:"gray",variant:"solid",onClick:c[0]||(c[0]=d=>s("update:step","email-add"))},{prefix:S(()=>[u(r,{class:"h-4 w-4"})]),_:1})]),!n(i).loading&&((h=n(i).data)!=null&&h.length)?(a(),l("div",ma,[(a(!0),l(L,null,R(n(i).data,d=>(a(),l("div",{key:d.name},[u(ua,{emailAccount:d,onClick:y=>s("update:step","email-edit",d)},null,8,["emailAccount","onClick"])]))),128))])):(a(),l("div",pa," Please add an email account to continue. "))])}}}),_a={class:"flex h-full flex-col gap-4"},Aa={class:"w-fit"},fa={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},ha={class:"text-wrap text-xs text-gray-700"},va=["href"],Ca={class:"flex flex-col gap-4"},ba={class:"grid grid-cols-1 gap-4"},ka={class:"grid grid-cols-2 gap-4"},ya={class:"text-p-sm text-gray-500"},xa={class:"mt-auto flex justify-between"},Ea=M({__name:"EmailEdit",props:{accountData:{default:null}},emits:["update:step"],setup(p,{emit:t}){var $,O,z,B;const s=p,i=t,o=T({email_account_name:s.accountData.email_account_name||"",service:s.accountData.service||"",email_id:s.accountData.email_id||"",api_key:(($=s.accountData)==null?void 0:$.api_key)||null,api_secret:((O=s.accountData)==null?void 0:O.api_secret)||null,password:((z=s.accountData)==null?void 0:z.password)||null,frappe_mail_site:((B=s.accountData)==null?void 0:B.frappe_mail_site)||"",enable_incoming:s.accountData.enable_incoming||!1,enable_outgoing:s.accountData.enable_outgoing||!1,default_outgoing:s.accountData.default_outgoing||!1,default_incoming:s.accountData.default_incoming||!1}),c={description:"To know more about setting up email accounts, click",link:"https://docs.erpnext.com/docs/user/manual/en/email-account"},r=V(()=>fe.find(g=>g.name===s.accountData.service).custom),f=V(()=>r.value?Ae:_e),h=b(),d=b(!1);async function y(){if(h.value=ve(o,r.value),h.value)return;const g={...s.accountData},x={...o},F=g.email_account_name!==x.email_account_name;delete g.email_account_name,delete x.email_account_name;const E=_.value,U=x;if(!F&&!E){Z({title:"No changes made",icon:"info",iconClasses:"text-blue-600"});return}if(F)try{d.value=!0,await v(),k()}catch{m()}if(E)try{d.value=!0,await D(U),k()}catch{m()}}const _=V(()=>o.email_id!==s.accountData.email_id||o.api_key!==s.accountData.api_key||o.api_secret!==s.accountData.api_secret||o.password!==s.accountData.password||o.enable_incoming!==s.accountData.enable_incoming||o.enable_outgoing!==s.accountData.enable_outgoing||o.default_outgoing!==s.accountData.default_outgoing||o.default_incoming!==s.accountData.default_incoming||o.frappe_mail_site!==s.accountData.frappe_mail_site);async function v(){return await X("frappe.client.rename_doc",{doctype:"Email Account",old_name:s.accountData.email_account_name,new_name:o.email_account_name})}async function D(g){return(await X("frappe.client.set_value",{doctype:"Email Account",name:o.email_account_name,fieldname:g})).name}function k(){i("update:step","email-list"),Z({title:"Email account updated successfully",icon:"check",iconClasses:"text-green-600"})}function m(){d.value=!1,h.value="Failed to update email account, Invalid credentials"}return(g,x)=>{const F=Q("FormControl"),E=Q("ErrorMessage"),U=Q("Button");return a(),l("div",_a,[x[2]||(x[2]=e("div",{role:"heading","aria-level":"1",class:"flex gap-1 justify-between"},[e("h5",{class:"text-lg font-semibold"},"Edit Email")],-1)),e("div",Aa,[u(Y,{logo:n(he)[g.accountData.service],"service-name":g.accountData.service},null,8,["logo","service-name"])]),e("div",fa,[u(n(le),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),e("div",ha,[q(w(c.description)+" ",1),e("a",{href:c.link,target:"_blank",class:"text-blue-500 underline"},"here",8,va),x[1]||(x[1]=q(" . "))])]),e("div",Ca,[e("div",ba,[(a(!0),l(L,null,R(f.value,A=>(a(),l("div",{key:A.name,class:"flex flex-col gap-1"},[u(F,{modelValue:o[A.name],"onUpdate:modelValue":j=>o[A.name]=j,label:A.label,name:A.name,type:A.type,placeholder:A.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),e("div",ka,[(a(!0),l(L,null,R(n(ge),A=>(a(),l("div",{key:A.name,class:"flex flex-col gap-1"},[u(F,{modelValue:o[A.name],"onUpdate:modelValue":j=>o[A.name]=j,label:A.label,name:A.name,type:A.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),e("p",ya,w(A.description),1)]))),128))]),h.value?(a(),I(E,{key:0,class:"ml-1",message:h.value},null,8,["message"])):C("",!0)]),e("div",xa,[u(U,{label:"Back",theme:"gray",variant:"outline",disabled:d.value,onClick:x[0]||(x[0]=A=>i("update:step","email-list"))},null,8,["disabled"]),u(U,{label:"Update Account",variant:"solid",onClick:y,loading:d.value},null,8,["loading"])])])}}}),wa={class:"flex-1"},Ia={key:0,class:"h-full"},Ba={key:1,class:"h-full"},Qa={key:2,class:"h-full"},$a=M({__name:"EmailConfig",setup(p){const t=b("email-list"),s=b(null);function i(o,c){t.value=o,s.value=c}return(o,c)=>(a(),l("div",wa,[t.value==="email-add"?(a(),l("div",Ia,[u(la,{"onUpdate:step":i})])):t.value==="email-list"?(a(),l("div",Ba,[u(ga,{"onUpdate:step":i})])):t.value==="email-edit"?(a(),l("div",Qa,[u(Ea,{"account-data":s.value,"onUpdate:step":i},null,8,["account-data"])])):C("",!0)]))}}),Sa={class:"flex flex-col gap-4"},La={class:"flex flex-col gap-2"},Da={class:"text-sm text-gray-600"},Va={class:"flex gap-4 items-center"},Ra={key:2},Fa=M({__name:"Branding",setup(p){var y;const t=Qe(),s=P({url:"frappe.client.get_value",cache:!0,params:{doctype:"Website Settings",fieldname:"favicon"},onSuccess(_){i.brandFavicon=_.favicon},auto:!0}),i=T({brandLogo:t.brandLogo,brandFavicon:((y=s.data)==null?void 0:y.favicon)||""}),o=T({logoLoading:!1,faviconLoading:!1}),c=V(()=>[{title:"Brand Logo",image:i.brandLogo,doctype:"HD Settings",fieldname:"brand_logo",loading:o.logoLoading},{title:"Brand Favicon",image:i.brandFavicon,doctype:"Website Settings",fieldname:"favicon",loading:o.faviconLoading}]),r=P({url:"frappe.client.set_value",debounce:1e3,onSuccess(_){_.doctype==="HD Settings"?h(_.brand_logo):d(_.favicon)},onError(){Z({title:"Failed to update, please try again",icon:"x",iconClasses:"text-red-600"}),o.logoLoading=!1,o.faviconLoading=!1}});function f(_,v,D){r.submit({doctype:v,name:v,fieldname:D,value:_}),v==="HD Settings"?o.logoLoading=!0:o.faviconLoading=!0}function h(_){i.brandLogo=_,o.logoLoading=!1,Z({title:"Brand Logo Updated",icon:"check",iconClasses:"text-green-600"})}function d(_){i.brandFavicon=_,o.faviconLoading=!1,Z({title:"Favicon Updated",text:"Please refresh the page to see the changes",icon:"check",iconClasses:"text-green-600"})}return(_,v)=>{const D=Q("Button");return a(),l("div",Sa,[v[0]||(v[0]=e("h1",{class:"text-lg font-semibold"},"Customise your Helpdesk",-1)),(a(!0),l(L,null,R(c.value,k=>(a(),l("div",La,[e("p",Da,w(k.title),1),e("div",Va,[k.image&&!k.loading?(a(),I(n(tt),{key:0,size:"3xl",image:k.image},null,8,["image"])):C("",!0),k.image?(a(),l("div",Ra,[u(D,{label:"Remove",onClick:m=>f("",k.doctype,k.fieldname),iconLeft:"trash",loading:k.loading},null,8,["onClick","loading"])])):(a(),I(n(at),{key:1,fileTypes:["image/*"],onSuccess:m=>{f(m.file_url,k.doctype,k.fieldname)}},{default:S(({openFileSelector:m})=>[u(D,{onClick:$=>m(),iconLeft:"upload",label:"Upload Image",loading:k.loading},null,8,["onClick","loading"])]),_:2},1032,["onSuccess"]))])]))),256))])}}}),Ma={class:"flex",style:{height:"calc(100vh - 8rem)"}},Ua={class:"flex w-52 shrink-0 flex-col bg-gray-50 p-2"},Pa={class:"mt-3"},Ja=["onClick"],Za={class:"text-base text-gray-800"},Na={class:"flex flex-1 flex-col overflow-scroll p-4"},Oa=M({__name:"SettingsModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(p){let t=[{label:"Email Accounts",icon:Pt,component:$a},{label:"Branding",icon:Nt,component:Fa}];const s=$e(p,"modelValue"),i=b(t[0]);return(o,c)=>(a(),I(n(Se),{modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=r=>s.value=r),options:{size:"4xl"}},{body:S(()=>[e("div",Ma,[e("div",Ua,[c[1]||(c[1]=e("h1",{class:"px-2 pt-2 text-lg font-semibold"},"Settings",-1)),e("div",Pa,[(a(!0),l(L,null,R(n(t),r=>{var f;return a(),l("button",{key:r.label,class:H(["flex h-7 w-full items-center gap-2 rounded px-2 py-1",[((f=i.value)==null?void 0:f.label)==r.label?"bg-white shadow-sm":"hover:bg-gray-100"]]),onClick:h=>i.value=r},[(a(),I(W(r.icon),{class:"h-4 w-4 text-gray-700"})),e("span",Za,w(r.label),1)],10,Ja)}),128))])]),e("div",Na,[i.value?(a(),I(W(i.value.component),{key:0})):C("",!0)])])]),_:1},8,["modelValue"]))}}),ja={class:"flex items-center gap-0.5 font-medium text-gray-600"},Ha={key:1,class:"mb-4"},Ta={key:0,class:"absolute z-20 h-1.5 w-1.5 translate-x-6 translate-y-1 rounded-full bg-blue-400 left-1",theme:"gray",variant:"solid"},qa={class:"overflow-y-auto"},za={key:0,class:"mx-2 my-2 h-1"},Ga=["onClick"],Wa={class:"flex flex-col"},Ya=M({__name:"Sidebar",setup(p){Le();const t=De(),s=Ve(),i=Re(),o=oe(),{isExpanded:c,width:r}=Fe(ne()),f=Me(),h=b(!1),{pinnedViews:d,publicViews:y}=Ze(),_=b(window.is_fc_site),v=V(()=>{var x,F;const g=[{label:"All Views",hideLabel:!0,opened:!0,views:J.value?qe:ze}];return(x=y.value)!=null&&x.length&&!J.value&&g.push({label:"Public Views",opened:!0,hideLabel:!1,views:D(y.value)}),(F=d.value)!=null&&F.length&&g.push({label:"Private Views",opened:!0,hideLabel:!1,views:D(d.value)}),g});function D(B){return B.map(g=>({label:g.label,icon:g.icon,to:{name:g.route_name,query:{view:g.name}},onClick:()=>{Ne.value={label:g.label,icon:g.icon}}}))}const k=V(()=>[{label:"Log out",icon:"log-out",onClick:()=>i.logout()}]),m=V(()=>[{component:N(Ge)},{label:"Customer portal",icon:"users",onClick:()=>{const B=s.resolve({name:Ue});window.open(B.href)}},{label:"Settings",icon:"settings",onClick:()=>h.value=!0,condition:()=>i.isAdmin||i.isManager},{label:"Log out",icon:"log-out",onClick:()=>i.logout()}]),$=V(()=>J.value?k.value:m.value);function O(B){var g;return t.query.view?t.query.view==((g=B==null?void 0:B.query)==null?void 0:g.view):t.name===B}function z(){window.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}return(B,g)=>{const x=Q("Badge"),F=Q("FeatherIcon");return a(),l("div",{class:"z-0 flex select-none flex-col border-r border-gray-200 bg-gray-50 p-2 text-base duration-300 ease-in-out",style:te({"min-width":n(r),"max-width":n(r)})},[u(We,{class:"mb-2 ml-0.5",options:$.value},null,8,["options"]),n(J)?C("",!0):(a(),I(n(G),{key:0,label:"Search",class:"mb-1",icon:n(Oe),"on-click":()=>z(),"is-expanded":n(c)},{right:S(()=>[e("span",ja,[(a(),I(W(n(f).modifierIcon),{class:"h-3 w-3"})),g[1]||(g[1]=e("span",null,"K",-1))])]),_:1},8,["icon","on-click","is-expanded"])),n(J)?C("",!0):(a(),l("div",Ha,[n(o).unread?(a(),l("div",Ta)):C("",!0),u(n(G),{class:"relative",label:"Notifications",icon:n(Ke),"on-click":()=>n(o).toggle(),"is-expanded":n(c)},{right:S(()=>[n(c)&&n(o).unread?(a(),I(x,{key:0,label:n(o).unread>9?"9+":n(o).unread,theme:"gray",variant:"subtle"},null,8,["label"])):C("",!0)]),_:1},8,["icon","on-click","is-expanded"])])),e("div",qa,[(a(!0),l(L,null,R(v.value,E=>{var U;return a(),l("div",{key:E.label},[!E.hideLabel&&!n(c)&&((U=E.views)!=null&&U.length)?(a(),l("div",za)):C("",!0),u(n(Ye),{label:E.label,hideLabel:E.hideLabel,opened:E.opened},{header:S(({opened:A,hide:j,toggle:Ce})=>[j?C("",!0):(a(),l("div",{key:0,class:H(["flex cursor-pointer gap-1.5 px-1 text-base font-medium text-ink-gray-5 transition-all duration-300 ease-in-out",n(c)?"mt-4 h-7 w-auto opacity-100":"ml-0 h-0 overflow-hidden opacity-0"]),onClick:en=>Ce()},[u(F,{name:"chevron-right",class:H(["h-4 text-ink-gray-9 transition-all duration-300 ease-in-out",{"rotate-90":A}])},null,8,["class"]),e("span",null,w(E.label),1)],10,Ga))]),default:S(()=>[e("nav",Wa,[(a(!0),l(L,null,R(E.views,A=>(a(),I(n(G),{icon:A.icon,label:A.label,to:A.to,key:A.label,"is-expanded":n(c),"is-active":O(A.to),class:"my-0.5 emoji",onClick:A.onClick},null,8,["icon","label","to","is-expanded","is-active","onClick"]))),128))])]),_:2},1032,["label","hideLabel","opened"])])}),128))]),g[2]||(g[2]=e("div",{class:"grow"},null,-1)),_.value&&!n(J)?(a(),I(n($t),{key:2,isSidebarCollapsed:!n(c)},null,8,["isSidebarCollapsed"])):C("",!0),u(n(G),{icon:n(c)?n(Dt):n(Ft),"is-active":!1,"is-expanded":n(c),label:n(c)?"Collapse":"Expand","on-click":()=>c.value=!n(c)},null,8,["icon","is-expanded","label","on-click"]),u(Oa,{modelValue:h.value,"onUpdate:modelValue":g[0]||(g[0]=E=>h.value=E)},null,8,["modelValue"])],4)}}}),Ka={class:"flex h-screen w-screen"},Xa={class:"flex-1 flex flex-col h-full overflow-auto"},gn={__name:"DesktopLayout",setup(p){return(t,s)=>(a(),l("div",Ka,[u(Ya),e("div",Xa,[u(kt),Pe(t.$slots,"default")]),u(n(_t)),u(n(je))]))}};export{gn as default};
//# sourceMappingURL=DesktopLayout-e3cbe070.js.map
