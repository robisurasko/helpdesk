{"version":3,"file":"TicketAgentFields-380db631.js","sources":["../../../../node_modules/@headlessui/vue/dist/internal/focus-sentinel.js","../../../../node_modules/@headlessui/vue/dist/components/tabs/tabs.js","../../../../node_modules/frappe-ui/src/components/Tabs/TabList.vue","../../../../node_modules/frappe-ui/src/components/Tabs/TabPanel.vue","../../../../node_modules/frappe-ui/src/components/Tabs/Tabs.vue","../../../../desk/src/components/icons/ActivityIcon.vue","../../../../desk/src/components/icons/CommentIcon.vue","../../../../desk/src/components/icons/AttachmentIcon.vue","../../../../desk/src/components/icons/ReplyIcon.vue","../../../../desk/src/components/icons/ReplyAllIcon.vue","../../../../desk/src/components/icons/ForwardIcon.vue","../../../../desk/src/components/SearchComplete.vue","../../../../desk/src/components/EmailEditor.vue","../../../../desk/src/components/CommentTextEditor.vue","../../../../desk/src/components/MultiSelectInput.vue","../../../../desk/src/components/CommunicationArea.vue","../../../../desk/src/components/ticket/TicketSplitModal.vue","../../../../desk/src/components/EmailArea.vue","../../../../desk/src/components/CommentBox.vue","../../../../desk/src/components/HistoryBox.vue","../../../../desk/src/components/AssignmentModal.vue","../../../../desk/src/components/CannedResponseSelectorModal.vue","../../../../desk/src/components/ticket/TicketAgentContact.vue","../../../../desk/src/components/ticket/ActivityHeader.vue","../../../../desk/src/components/ticket/TicketAgentActivities.vue","../../../../desk/src/components/ticket/TicketAgentDetails.vue","../../../../desk/src/components/UniInput2.vue","../../../../desk/src/components/ticket/TicketAgentFields.vue"],"sourcesContent":["import{defineComponent as i,h as m,ref as f}from\"vue\";import{Features as l,Hidden as F}from'./hidden.js';let d=i({props:{onFocus:{type:Function,required:!0}},setup(t){let n=f(!0);return()=>n.value?m(F,{as:\"button\",type:\"button\",features:l.Focusable,onFocus(o){o.preventDefault();let e,a=50;function r(){var u;if(a--<=0){e&&cancelAnimationFrame(e);return}if((u=t.onFocus)!=null&&u.call(t)){n.value=!1,cancelAnimationFrame(e);return}e=requestAnimationFrame(r)}e=requestAnimationFrame(r)}}):null}});export{d as FocusSentinel};\n","import{computed as v,defineComponent as L,Fragment as z,h as A,inject as j,onMounted as F,onUnmounted as K,provide as N,ref as P,watch as _,watchEffect as J}from\"vue\";import{useId as $}from'../../hooks/use-id.js';import{useResolveButtonType as Q}from'../../hooks/use-resolve-button-type.js';import{FocusSentinel as V}from'../../internal/focus-sentinel.js';import{Hidden as X}from'../../internal/hidden.js';import{Keys as S}from'../../keyboard.js';import{dom as f}from'../../utils/dom.js';import{Focus as g,focusIn as D,FocusResult as B,sortByDomNode as k}from'../../utils/focus-management.js';import{match as H}from'../../utils/match.js';import{microTask as Y}from'../../utils/micro-task.js';import{getOwnerDocument as Z}from'../../utils/owner.js';import{Features as q,omit as ee,render as M}from'../../utils/render.js';var te=(s=>(s[s.Forwards=0]=\"Forwards\",s[s.Backwards=1]=\"Backwards\",s))(te||{}),le=(d=>(d[d.Less=-1]=\"Less\",d[d.Equal=0]=\"Equal\",d[d.Greater=1]=\"Greater\",d))(le||{});let U=Symbol(\"TabsContext\");function C(a){let b=j(U,null);if(b===null){let s=new Error(`<${a} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,C),s}return b}let G=Symbol(\"TabsSSRContext\"),me=L({name:\"TabGroup\",emits:{change:a=>!0},props:{as:{type:[Object,String],default:\"template\"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(a,{slots:b,attrs:s,emit:d}){var E;let i=P((E=a.selectedIndex)!=null?E:a.defaultIndex),l=P([]),r=P([]),p=v(()=>a.selectedIndex!==null),R=v(()=>p.value?a.selectedIndex:i.value);function y(t){var c;let n=k(u.tabs.value,f),o=k(u.panels.value,f),e=n.filter(I=>{var m;return!((m=f(I))!=null&&m.hasAttribute(\"disabled\"))});if(t<0||t>n.length-1){let I=H(i.value===null?0:Math.sign(t-i.value),{[-1]:()=>1,[0]:()=>H(Math.sign(t),{[-1]:()=>0,[0]:()=>0,[1]:()=>1}),[1]:()=>0}),m=H(I,{[0]:()=>n.indexOf(e[0]),[1]:()=>n.indexOf(e[e.length-1])});m!==-1&&(i.value=m),u.tabs.value=n,u.panels.value=o}else{let I=n.slice(0,t),h=[...n.slice(t),...I].find(W=>e.includes(W));if(!h)return;let O=(c=n.indexOf(h))!=null?c:u.selectedIndex.value;O===-1&&(O=u.selectedIndex.value),i.value=O,u.tabs.value=n,u.panels.value=o}}let u={selectedIndex:v(()=>{var t,n;return(n=(t=i.value)!=null?t:a.defaultIndex)!=null?n:null}),orientation:v(()=>a.vertical?\"vertical\":\"horizontal\"),activation:v(()=>a.manual?\"manual\":\"auto\"),tabs:l,panels:r,setSelectedIndex(t){R.value!==t&&d(\"change\",t),p.value||y(t)},registerTab(t){var o;if(l.value.includes(t))return;let n=l.value[i.value];if(l.value.push(t),l.value=k(l.value,f),!p.value){let e=(o=l.value.indexOf(n))!=null?o:i.value;e!==-1&&(i.value=e)}},unregisterTab(t){let n=l.value.indexOf(t);n!==-1&&l.value.splice(n,1)},registerPanel(t){r.value.includes(t)||(r.value.push(t),r.value=k(r.value,f))},unregisterPanel(t){let n=r.value.indexOf(t);n!==-1&&r.value.splice(n,1)}};N(U,u);let T=P({tabs:[],panels:[]}),x=P(!1);F(()=>{x.value=!0}),N(G,v(()=>x.value?null:T.value));let w=v(()=>a.selectedIndex);return F(()=>{_([w],()=>{var t;return y((t=a.selectedIndex)!=null?t:a.defaultIndex)},{immediate:!0})}),J(()=>{if(!p.value||R.value==null||u.tabs.value.length<=0)return;let t=k(u.tabs.value,f);t.some((o,e)=>f(u.tabs.value[e])!==f(o))&&u.setSelectedIndex(t.findIndex(o=>f(o)===f(u.tabs.value[R.value])))}),()=>{let t={selectedIndex:i.value};return A(z,[l.value.length<=0&&A(V,{onFocus:()=>{for(let n of l.value){let o=f(n);if((o==null?void 0:o.tabIndex)===0)return o.focus(),!0}return!1}}),M({theirProps:{...s,...ee(a,[\"selectedIndex\",\"defaultIndex\",\"manual\",\"vertical\",\"onChange\"])},ourProps:{},slot:t,slots:b,attrs:s,name:\"TabGroup\"})])}}}),pe=L({name:\"TabList\",props:{as:{type:[Object,String],default:\"div\"}},setup(a,{attrs:b,slots:s}){let d=C(\"TabList\");return()=>{let i={selectedIndex:d.selectedIndex.value},l={role:\"tablist\",\"aria-orientation\":d.orientation.value};return M({ourProps:l,theirProps:a,slot:i,attrs:b,slots:s,name:\"TabList\"})}}}),xe=L({name:\"Tab\",props:{as:{type:[Object,String],default:\"button\"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(a,{attrs:b,slots:s,expose:d}){var o;let i=(o=a.id)!=null?o:`headlessui-tabs-tab-${$()}`,l=C(\"Tab\"),r=P(null);d({el:r,$el:r}),F(()=>l.registerTab(r)),K(()=>l.unregisterTab(r));let p=j(G),R=v(()=>{if(p.value){let e=p.value.tabs.indexOf(i);return e===-1?p.value.tabs.push(i)-1:e}return-1}),y=v(()=>{let e=l.tabs.value.indexOf(r);return e===-1?R.value:e}),u=v(()=>y.value===l.selectedIndex.value);function T(e){var I;let c=e();if(c===B.Success&&l.activation.value===\"auto\"){let m=(I=Z(r))==null?void 0:I.activeElement,h=l.tabs.value.findIndex(O=>f(O)===m);h!==-1&&l.setSelectedIndex(h)}return c}function x(e){let c=l.tabs.value.map(m=>f(m)).filter(Boolean);if(e.key===S.Space||e.key===S.Enter){e.preventDefault(),e.stopPropagation(),l.setSelectedIndex(y.value);return}switch(e.key){case S.Home:case S.PageUp:return e.preventDefault(),e.stopPropagation(),T(()=>D(c,g.First));case S.End:case S.PageDown:return e.preventDefault(),e.stopPropagation(),T(()=>D(c,g.Last))}if(T(()=>H(l.orientation.value,{vertical(){return e.key===S.ArrowUp?D(c,g.Previous|g.WrapAround):e.key===S.ArrowDown?D(c,g.Next|g.WrapAround):B.Error},horizontal(){return e.key===S.ArrowLeft?D(c,g.Previous|g.WrapAround):e.key===S.ArrowRight?D(c,g.Next|g.WrapAround):B.Error}}))===B.Success)return e.preventDefault()}let w=P(!1);function E(){var e;w.value||(w.value=!0,!a.disabled&&((e=f(r))==null||e.focus({preventScroll:!0}),l.setSelectedIndex(y.value),Y(()=>{w.value=!1})))}function t(e){e.preventDefault()}let n=Q(v(()=>({as:a.as,type:b.type})),r);return()=>{var m,h;let e={selected:u.value,disabled:(m=a.disabled)!=null?m:!1},{...c}=a,I={ref:r,onKeydown:x,onMousedown:t,onClick:E,id:i,role:\"tab\",type:n.value,\"aria-controls\":(h=f(l.panels.value[y.value]))==null?void 0:h.id,\"aria-selected\":u.value,tabIndex:u.value?0:-1,disabled:a.disabled?!0:void 0};return M({ourProps:I,theirProps:c,slot:e,attrs:b,slots:s,name:\"Tab\"})}}}),Ie=L({name:\"TabPanels\",props:{as:{type:[Object,String],default:\"div\"}},setup(a,{slots:b,attrs:s}){let d=C(\"TabPanels\");return()=>{let i={selectedIndex:d.selectedIndex.value};return M({theirProps:a,ourProps:{},slot:i,attrs:s,slots:b,name:\"TabPanels\"})}}}),ye=L({name:\"TabPanel\",props:{as:{type:[Object,String],default:\"div\"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(a,{attrs:b,slots:s,expose:d}){var T;let i=(T=a.id)!=null?T:`headlessui-tabs-panel-${$()}`,l=C(\"TabPanel\"),r=P(null);d({el:r,$el:r}),F(()=>l.registerPanel(r)),K(()=>l.unregisterPanel(r));let p=j(G),R=v(()=>{if(p.value){let x=p.value.panels.indexOf(i);return x===-1?p.value.panels.push(i)-1:x}return-1}),y=v(()=>{let x=l.panels.value.indexOf(r);return x===-1?R.value:x}),u=v(()=>y.value===l.selectedIndex.value);return()=>{var n;let x={selected:u.value},{tabIndex:w,...E}=a,t={ref:r,id:i,role:\"tabpanel\",\"aria-labelledby\":(n=f(l.tabs.value[y.value]))==null?void 0:n.id,tabIndex:u.value?w:-1};return!u.value&&a.unmount&&!a.static?A(X,{as:\"span\",\"aria-hidden\":!0,...t}):M({ourProps:t,theirProps:E,slot:x,attrs:b,slots:s,features:q.Static|q.RenderStrategy,visible:u.value,name:\"TabPanel\"})}}});export{xe as Tab,me as TabGroup,pe as TabList,ye as TabPanel,Ie as TabPanels};\n","<template>\n  <TabList\n    class=\"relative flex\"\n    :class=\"\n      t.vertical\n        ? 'flex-col border-r overflow-y-auto'\n        : 'gap-7.5 border-b overflow-x-auto items-center px-5'\n    \"\n  >\n    <Tab\n      ref=\"tabRef\"\n      as=\"template\"\n      v-for=\"(tab, i) in t.tabs\"\n      :key=\"i\"\n      v-slot=\"{ selected }\"\n      class=\"focus:outline-none focus:transition-none\"\n    >\n      <slot v-bind=\"{ tab, selected }\">\n        <button\n          class=\"flex items-center gap-1.5 text-base text-ink-gray-5 duration-300 ease-in-out hover:text-ink-gray-9\"\n          :class=\"[\n            selected ? 'text-ink-gray-9' : '',\n            t.vertical\n              ? 'py-2.5 px-4 border-r border-transparent hover:border-outline-gray-3'\n              : 'py-3 border-b border-transparent hover:border-outline-gray-3',\n          ]\"\n        >\n          <component v-if=\"tab.icon\" :is=\"tab.icon\" class=\"size-4\" />\n          {{ tab.label }}\n        </button>\n      </slot>\n    </Tab>\n    <div\n      ref=\"indicator\"\n      class=\"tab-indicator absolute bg-surface-gray-7\"\n      :class=\"[t.vertical ? 'right-0 w-px' : 'bottom-0 h-px', transitionClass]\"\n    />\n  </TabList>\n</template>\n<script setup>\nimport { TabList, Tab } from '@headlessui/vue'\nimport { ref, watch, computed, onMounted, nextTick, inject } from 'vue'\n\nconst t = inject('tab')\n\nconst tabRef = ref([])\nconst indicator = ref(null)\nconst tabsLength = computed(() => t.value.tabs.value?.length)\n\nconst transitionClass = ref('')\n\nfunction moveIndicator(index) {\n  if (index >= tabsLength.value) {\n    index = tabsLength.value - 1\n  }\n  const selectedTab = tabRef.value[index].el\n  if (t.value.vertical.value) {\n    indicator.value.style.height = `${selectedTab.offsetHeight}px`\n    indicator.value.style.top = `${selectedTab.offsetTop}px`\n  } else {\n    indicator.value.style.width = `${selectedTab.offsetWidth}px`\n    indicator.value.style.left = `${selectedTab.offsetLeft}px`\n  }\n}\n\nwatch(\n  () => t.value.tabIndex.value,\n  (index) => {\n    if (index >= tabsLength.value) {\n      t.value.tabIndex.value = tabsLength.value - 1\n    }\n    transitionClass.value = 'transition-all duration-300 ease-in-out'\n    nextTick(() => moveIndicator(index))\n  },\n)\n\nonMounted(() => {\n  nextTick(() => moveIndicator(t.value.tabIndex.value))\n  // Fix for indicator not moving on initial load\n  setTimeout(() => moveIndicator(t.value.tabIndex.value), 100)\n})\n</script>\n","<template>\n  <TabPanels class=\"flex flex-1 overflow-hidden\">\n    <TabPanel\n      class=\"flex flex-1 flex-col overflow-y-auto focus:outline-none\"\n      v-for=\"(tab, i) in t.tabs\"\n      :key=\"i\"\n    >\n      <slot v-bind=\"{ tab }\" />\n    </TabPanel>\n  </TabPanels>\n</template>\n<script setup>\nimport { TabPanels, TabPanel } from '@headlessui/vue'\nimport { inject } from 'vue'\n\nconst t = inject('tab')\n</script>\n","<template>\n  <TabGroup\n    v-bind=\"\n      as !== 'template'\n        ? {\n            as,\n            class: ['flex flex-1 overflow-hidden', vertical ? '' : 'flex-col '],\n          }\n        : {}\n    \"\n    :defaultIndex=\"tabIndex\"\n    :selectedIndex=\"tabIndex\"\n    @change=\"(idx) => (tabIndex = idx)\"\n  >\n    <slot>\n      <TabList v-slot=\"{ tab, selected }\">\n        <slot name=\"tab-item\" v-bind=\"{ tab, selected }\" />\n      </TabList>\n      <TabPanel v-slot=\"{ tab }\">\n        <slot name=\"tab-panel\" v-bind=\"{ tab }\" />\n      </TabPanel>\n    </slot>\n  </TabGroup>\n</template>\n\n<script setup>\nimport TabList from './TabList.vue'\nimport TabPanel from './TabPanel.vue'\nimport { TabGroup } from '@headlessui/vue'\nimport { computed, provide } from 'vue'\n\nconst props = defineProps({\n  as: {\n    type: String,\n    default: 'template',\n  },\n  tabs: {\n    type: Array,\n    required: true,\n  },\n  vertical: {\n    type: Boolean,\n    default: false,\n  },\n})\n\nconst tabIndex = defineModel()\n\nprovide(\n  'tab',\n  computed(() => ({\n    tabIndex,\n    tabs: props.tabs,\n    vertical: props.vertical,\n  })),\n)\n</script>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M6.29021 2.64272C6.68375 0.785763 9.33429 0.785757 9.72783 2.64272L10.3657 5.65238L13.3753 6.29021C15.2323 6.68375 15.2323 9.33429 13.3753 9.72783L10.3657 10.3657L9.72783 13.3753C9.33429 15.2323 6.68375 15.2323 6.29021 13.3753L5.65238 10.3657L2.64272 9.72783C0.785763 9.33429 0.785757 6.68375 2.64272 6.29021L5.65238 5.65238L6.29021 2.64272ZM8.74956 2.85004C8.58 2.04999 7.43804 2.04998 7.26848 2.85004L6.56324 6.17777L6.49584 6.49583L6.17777 6.56324L2.85004 7.26848C2.04999 7.43804 2.04998 8.58 2.85004 8.74956L6.17777 9.4548L6.49584 9.5222L6.56324 9.84027L7.26848 13.168C7.43804 13.9681 8.58 13.9681 8.74956 13.168L9.4548 9.84027L9.5222 9.5222L9.84027 9.4548L13.168 8.74956C13.9681 8.58 13.9681 7.43804 13.168 7.26848L9.84027 6.56324L9.5222 6.49583L9.4548 6.17777L8.74956 2.85004Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M8 2.5C4.2911 2.5 1.5 4.84419 1.5 7.5C1.5 9.14452 2.54729 10.6518 4.25112 11.5816C4.50048 11.7177 4.758 12.0041 4.7326 12.4082C4.71107 12.7508 4.61659 13.2533 4.47175 13.6657C4.44071 13.7541 4.40789 13.8389 4.37434 13.9195C4.62005 13.8524 4.91964 13.7411 5.26646 13.5579C5.48882 13.4404 5.69385 13.2901 5.9102 13.1207C5.95058 13.089 5.9922 13.056 6.03481 13.0222C6.20816 12.8848 6.39803 12.7342 6.58835 12.6102C6.7875 12.4803 7.01146 12.4447 7.20831 12.4631C7.46767 12.4875 7.73186 12.5 8 12.5C11.7089 12.5 14.5 10.1558 14.5 7.5C14.5 4.84419 11.7089 2.5 8 2.5ZM0.5 7.5C0.5 4.08068 3.97691 1.5 8 1.5C12.0231 1.5 15.5 4.08068 15.5 7.5C15.5 10.9193 12.0231 13.5 8 13.5C7.70158 13.5 7.40709 13.4861 7.11751 13.459C6.97583 13.5528 6.83777 13.6621 6.67569 13.7905C6.62832 13.828 6.5789 13.8671 6.52674 13.908C6.30071 14.085 6.03818 14.2812 5.73354 14.4421C4.73389 14.9702 3.9948 15.0302 3.62977 15.0147C3.39759 15.0048 3.20936 14.8646 3.12194 14.6754C3.03801 14.4938 3.05143 14.2816 3.15736 14.1099C3.24804 13.963 3.40655 13.6808 3.52825 13.3343C3.62961 13.0457 3.70134 12.6878 3.72712 12.4347C1.81521 11.3748 0.5 9.58517 0.5 7.5Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M12.5684 2.50774C11.5403 1.49742 9.95026 1.49742 8.92215 2.50774L3.62404 7.71417C2.12532 9.18695 2.12532 11.669 3.62404 13.1418C5.12762 14.6194 7.66861 14.6194 9.17219 13.1418L12.1609 10.2049C12.3578 10.0113 12.6744 10.0141 12.8679 10.211C13.0615 10.408 13.0587 10.7246 12.8618 10.9181L9.8731 13.8551C7.98045 15.715 4.81578 15.715 2.92313 13.8551C1.02562 11.9904 1.02562 8.86558 2.92313 7.00091L8.22124 1.79449C9.63842 0.401838 11.8521 0.401838 13.2693 1.79449C14.6914 3.19191 14.6914 5.38225 13.2693 6.77968L13.2668 6.78213L13.2668 6.78212L8.37876 11.5189C8.37834 11.5193 8.37793 11.5197 8.37752 11.5201C7.51767 12.3638 6.11144 12.3939 5.29119 11.5097C4.43611 10.6596 4.40778 9.26893 5.30922 8.46081L7.33823 6.46692C7.53518 6.27337 7.85175 6.27613 8.04531 6.47309C8.23886 6.67005 8.23609 6.98662 8.03913 7.18017L6.0014 9.18264L5.99203 9.19185L5.98219 9.20055C5.5391 9.59243 5.5104 10.3231 6.0014 10.8056L6.01078 10.8148L6.01967 10.8245C6.42299 11.2649 7.18224 11.2926 7.67785 10.8056L7.68034 10.8032L7.68035 10.8032L12.5684 6.06643C12.5688 6.06604 12.5692 6.06565 12.5696 6.06526C13.5917 5.05969 13.5913 3.51289 12.5684 2.50774Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M5.64645 3.14645C5.84171 2.95118 6.15829 2.95118 6.35355 3.14645C6.54882 3.34171 6.54882 3.65829 6.35355 3.85355L3.20711 7H10C12.4853 7 14.5 9.01472 14.5 11.5V12C14.5 12.2761 14.2761 12.5 14 12.5C13.7239 12.5 13.5 12.2761 13.5 12V11.5C13.5 9.567 11.933 8 10 8H3.20711L6.35355 11.1464C6.54882 11.3417 6.54882 11.6583 6.35355 11.8536C6.15829 12.0488 5.84171 12.0488 5.64645 11.8536L1.64645 7.85355C1.45118 7.65829 1.45118 7.34171 1.64645 7.14645L5.64645 3.14645Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M5.85355 3.14645C5.65829 2.95118 5.34171 2.95118 5.14645 3.14645L1.14645 7.14645C0.951184 7.34171 0.951184 7.65829 1.14645 7.85355L5.14645 11.8536C5.34171 12.0488 5.65829 12.0488 5.85355 11.8536C6.04882 11.6583 6.04882 11.3417 5.85355 11.1464L2.20711 7.5L5.85355 3.85355C6.04882 3.65829 6.04882 3.34171 5.85355 3.14645ZM10 8C11.933 8 13.5 9.567 13.5 11.5V12C13.5 12.2761 13.7239 12.5 14 12.5C14.2761 12.5 14.5 12.2761 14.5 12V11.5C14.5 9.01472 12.4853 7 10 7H6.6728L9.81924 3.85355C10.0145 3.65829 10.0145 3.34171 9.81924 3.14645C9.62398 2.95118 9.3074 2.95118 9.11214 3.14645L5.11214 7.14645C4.91688 7.34171 4.91688 7.65829 5.11214 7.85355L9.11214 11.8536C9.3074 12.0488 9.62398 12.0488 9.81924 11.8536C10.0145 11.6583 10.0145 11.3417 9.81924 11.1464L6.6728 8H10Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    stroke-width=\"2\"\n    stroke-linecap=\"round\"\n    stroke-linejoin=\"round\"\n    class=\"lucide lucide-forward\"\n  >\n    <polyline points=\"15 17 20 12 15 7\"></polyline>\n    <path d=\"M4 18v-2a4 4 0 0 1 4-4h12\"></path>\n  </svg>\n</template>","<template>\n  <Autocomplete\n    placeholder=\"Select an option\"\n    :options=\"options\"\n    :value=\"selection\"\n    @update:query=\"(q) => onUpdateQuery(q)\"\n    @change=\"\n      (v) => {\n        if (!resetInput) {\n          selection = v;\n        }\n        emit('change', v);\n      }\n    \"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { Autocomplete } from \"@/components\";\nimport { createListResource } from \"frappe-ui\";\nimport { computed, ref } from \"vue\";\n\nconst emit = defineEmits([\"change\"]);\n\nconst props = defineProps({\n  value: {\n    type: String,\n    required: false,\n    default: \"\",\n  },\n  doctype: {\n    type: String,\n    required: true,\n  },\n  searchField: {\n    type: String,\n    required: false,\n    default: \"name\",\n  },\n  labelField: {\n    type: String,\n    required: false,\n    default: \"name\",\n  },\n  valueField: {\n    type: String,\n    required: false,\n    default: \"name\",\n  },\n  pageLength: {\n    type: Number,\n    required: false,\n    default: 100,\n  },\n  resetInput: {\n    type: Boolean,\n    required: false,\n    default: false,\n  },\n  customFilters: {\n    type: Object,\n    required: false,\n    default: {},\n  },\n});\n\nconst r = createListResource({\n  doctype: props.doctype,\n  pageLength: props.pageLength,\n  auto: true,\n  fields: [props.labelField, props.searchField, props.valueField],\n  filters: {\n    [props.searchField]: [\"like\", `%${props.value}%`],\n    ...props.customFilters,\n  },\n  onSuccess: () => {\n    selection.value = props.value\n      ? options.value.find((o) => o.value === props.value)\n      : null;\n  },\n});\nconst options = computed(\n  () =>\n    r.data?.map((result) => ({\n      label: result[props.labelField],\n      value: result[props.valueField],\n    })) || []\n);\nconst selection = ref(null);\n\nfunction onUpdateQuery(query: string) {\n  r.update({\n    filters: {\n      [props.searchField]: [\"like\", `%${query}%`],\n      ...props.customFilters,\n    },\n  });\n\n  r.reload();\n}\n</script>\n","<template>\n  <TextEditor\n    ref=\"editorRef\"\n    :editor-class=\"[\n      'prose-sm max-w-none mx-10 max-h-[50vh] overflow-y-auto py-3',\n      'min-h-[7rem]',\n      getFontFamily(newEmail),\n    ]\"\n    :content=\"newEmail\"\n    :starterkit-options=\"{ heading: { levels: [2, 3, 4, 5, 6] } }\"\n    :placeholder=\"placeholder\"\n    :editable=\"editable\"\n    @change=\"editable ? (newEmail = $event) : null\"\n    :extensions=\"[PreserveVideoControls]\"\n  >\n    <template #top>\n      <div class=\"mx-10 flex items-center gap-2 border-y py-2.5\">\n        <span class=\"text-xs text-gray-500\">TO:</span>\n        <MultiSelectInput\n          v-model=\"toEmailsClone\"\n          class=\"flex-1\"\n          :validate=\"validateEmail\"\n          :error-message=\"(value) => `${value} is an invalid email address`\"\n        />\n        <Button\n          :label=\"'CC'\"\n          :class=\"[cc ? 'bg-gray-300 hover:bg-gray-200' : '']\"\n          @click=\"toggleCC()\"\n        />\n        <Button\n          :label=\"'BCC'\"\n          :class=\"[bcc ? 'bg-gray-300 hover:bg-gray-200' : '']\"\n          @click=\"toggleBCC()\"\n        />\n      </div>\n      <div\n        v-if=\"showCC || cc\"\n        class=\"mx-10 flex items-center gap-2 py-2.5\"\n        :class=\"cc || showCC ? 'border-b' : ''\"\n      >\n        <span class=\"text-xs text-gray-500\">CC:</span>\n        <MultiSelectInput\n          ref=\"ccInput\"\n          v-model=\"ccEmailsClone\"\n          class=\"flex-1\"\n          :validate=\"validateEmail\"\n          :error-message=\"(value) => `${value} is an invalid email address`\"\n        />\n      </div>\n      <div\n        v-if=\"showBCC || bcc\"\n        class=\"mx-10 flex items-center gap-2 py-2.5\"\n        :class=\"bcc || showBCC ? 'border-b' : ''\"\n      >\n        <span class=\"text-xs text-gray-500\">BCC:</span>\n        <MultiSelectInput\n          ref=\"bccInput\"\n          v-model=\"bccEmailsClone\"\n          class=\"flex-1\"\n          :validate=\"validateEmail\"\n          :error-message=\"(value) => `${value} is an invalid email address`\"\n        />\n      </div>\n    </template>\n    <template #bottom>\n      <div class=\"flex flex-wrap gap-2 px-10\">\n        <AttachmentItem\n          v-for=\"a in attachments\"\n          :key=\"a.file_url\"\n          :label=\"a.file_name\"\n        >\n          <template #suffix>\n            <FeatherIcon\n              class=\"h-3.5\"\n              name=\"x\"\n              @click.stop=\"removeAttachment(a)\"\n            />\n          </template>\n        </AttachmentItem>\n      </div>\n      <div class=\"flex justify-between gap-2 overflow-hidden px-10 py-2.5\">\n        <div class=\"flex items-center overflow-x-auto\">\n          <TextEditorFixedMenu class=\"-ml-1\" :buttons=\"textEditorMenuButtons\" />\n          <div class=\"flex gap-1\">\n            <FileUploader\n              :upload-args=\"{\n                doctype: doctype,\n                docname: modelValue?.name,\n                private: true,\n              }\"\n              @success=\"\n                (f) => {\n                  attachments.push(f);\n                }\n              \"\n            >\n              <template #default=\"{ openFileSelector }\">\n                <Button variant=\"ghost\" @click=\"openFileSelector()\">\n                  <template #icon>\n                    <AttachmentIcon\n                      class=\"h-4\"\n                      style=\"color: #000000; stroke-width: 1.5 !important\"\n                    />\n                  </template>\n                </Button>\n              </template>\n            </FileUploader>\n            <Button\n              variant=\"ghost\"\n              @click=\"showCannedResponseSelectorModal = true\"\n            >\n              <template #icon>\n                <EmailIcon\n                  class=\"h-4\"\n                  style=\"color: #000000; stroke-width: 1.2\"\n                />\n              </template>\n            </Button>\n          </div>\n        </div>\n        <div class=\"mt-2 flex items-center justify-end space-x-2 sm:mt-0\">\n          <Button label=\"Discard\" @click=\"handleDiscard\" />\n          <Button\n            variant=\"solid\"\n            :disabled=\"emailEmpty\"\n            :loading=\"sendMail.loading\"\n            label=\"Send\"\n            @click=\"\n              () => {\n                submitMail();\n              }\n            \"\n          />\n        </div>\n      </div>\n    </template>\n  </TextEditor>\n  <CannedResponseSelectorModal\n    v-model=\"showCannedResponseSelectorModal\"\n    :doctype=\"doctype\"\n    @apply=\"applyCannedResponse\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, nextTick } from \"vue\";\nimport { useStorage } from \"@vueuse/core\";\nimport {\n  FileUploader,\n  TextEditor,\n  TextEditorFixedMenu,\n  createResource,\n} from \"frappe-ui\";\nimport {\n  createToast,\n  validateEmail,\n  textEditorMenuButtons,\n  isContentEmpty,\n  getFontFamily,\n} from \"@/utils\";\nimport {\n  MultiSelectInput,\n  AttachmentItem,\n  CannedResponseSelectorModal,\n} from \"@/components\";\nimport { AttachmentIcon, EmailIcon } from \"@/components/icons\";\nimport { PreserveVideoControls } from \"@/tiptap-extensions\";\n\nconst editorRef = ref(null);\nconst showCannedResponseSelectorModal = ref(false);\n\nconst props = defineProps({\n  placeholder: {\n    type: String,\n    default: null,\n  },\n  editable: {\n    type: Boolean,\n    default: true,\n  },\n  doctype: {\n    type: String,\n    default: \"HD Ticket\",\n  },\n  toEmails: {\n    type: Array,\n    default: () => [],\n  },\n  ccEmails: {\n    type: Array,\n    default: () => [],\n  },\n  bccEmails: {\n    type: Array,\n    default: () => [],\n  },\n});\nconst emit = defineEmits([\"submit\", \"discard\"]);\nconst doc = defineModel();\n\nconst newEmail = useStorage(\"emailBoxContent\" + doc.value.name, \"\");\nconst attachments = ref([]);\nconst emailEmpty = computed(() => {\n  return isContentEmpty(newEmail.value);\n});\n\nconst toEmailsClone = ref([...props.toEmails]);\nconst ccEmailsClone = ref([...props.ccEmails]);\nconst bccEmailsClone = ref([...props.bccEmails]);\nconst showCC = ref(false);\nconst showBCC = ref(false);\nconst cc = computed(() => (ccEmailsClone.value?.length ? true : false));\nconst bcc = computed(() => (bccEmailsClone.value?.length ? true : false));\nconst ccInput = ref(null);\nconst bccInput = ref(null);\n\nfunction applyCannedResponse(template) {\n  newEmail.value = template.message;\n  showCannedResponseSelectorModal.value = false;\n}\n\nconst sendMail = createResource({\n  url: \"run_doc_method\",\n  makeParams: () => ({\n    dt: props.doctype,\n    dn: doc.value.name,\n    method: \"reply_via_agent\",\n    args: {\n      attachments: attachments.value.map((x) => x.name),\n      to: toEmailsClone.value.join(\",\"),\n      cc: ccEmailsClone.value?.join(\",\"),\n      bcc: bccEmailsClone.value?.join(\",\"),\n      message: newEmail.value,\n    },\n  }),\n  onSuccess: () => {\n    resetState();\n    emit(\"submit\");\n  },\n  debounce: 300,\n});\n\nfunction submitMail() {\n  if (isContentEmpty(newEmail.value)) {\n    return;\n  }\n  if (!toEmailsClone.value.length) {\n    createToast({\n      text: \"Please enter a recipient email address\",\n      icon: \"x\",\n      iconClasses: \"text-red-600\",\n    });\n    return;\n  }\n\n  sendMail.submit();\n}\n\nfunction toggleCC() {\n  showCC.value = !showCC.value;\n\n  showCC.value &&\n    nextTick(() => {\n      ccInput.value.setFocus();\n    });\n}\n\nfunction toggleBCC() {\n  showBCC.value = !showBCC.value;\n  showBCC.value &&\n    nextTick(() => {\n      bccInput.value.setFocus();\n    });\n}\n\nfunction removeAttachment(attachment) {\n  attachments.value = attachments.value.filter((a) => a !== attachment);\n}\n\nfunction addToReply(\n  body: string,\n  toEmails: string[],\n  ccEmails: string[],\n  bccEmails: string[]\n) {\n  toEmailsClone.value = toEmails;\n  ccEmailsClone.value = ccEmails;\n  bccEmailsClone.value = bccEmails;\n  editorRef.value.editor\n    .chain()\n    .clearContent()\n    .insertContent(body)\n    .focus(\"all\")\n    .setBlockquote()\n    .insertContentAt(0, { type: \"paragraph\" })\n    .focus(\"start\")\n    .run();\n}\n\nfunction addToForward(body: string, subject: string, _attachments: any[]) {\n  newEmail.value = body;\n  attachments.value = _attachments;\n  editorRef.value.editor\n    .chain()\n    .clearContent()\n    .insertContent(body)\n    .focus(\"all\")\n    // .setBlockquote()\n    .insertContentAt(0, { type: \"paragraph\" })\n    .focus(\"start\")\n    .run();\n}\n\nfunction resetState() {\n  newEmail.value = null;\n  attachments.value = [];\n}\n\nfunction handleDiscard() {\n  attachments.value = [];\n  newEmail.value = null;\n\n  ccEmailsClone.value = [];\n  bccEmailsClone.value = [];\n  ccEmailsClone.value = [];\n  showCC.value = false;\n  showBCC.value = false;\n\n  emit(\"discard\");\n}\n\nconst editor = computed(() => {\n  return editorRef.value.editor;\n});\n\ndefineExpose({\n  addToReply,\n  addToForward,\n  editor,\n  submitMail,\n});\n</script>\n","<template>\n  <TextEditor\n    v-if=\"agentsList.data\"\n    ref=\"textEditor\"\n    :editor-class=\"[\n      'prose-sm max-w-none',\n      editable &&\n        'min-h-[7rem] mx-10 max-h-[50vh] overflow-y-auto border-t py-3',\n      getFontFamily(newComment),\n    ]\"\n    :content=\"newComment\"\n    :starterkit-options=\"{ heading: { levels: [2, 3, 4, 5, 6] } }\"\n    :placeholder=\"placeholder\"\n    :editable=\"editable\"\n    :mentions=\"agents\"\n    @change=\"editable ? (newComment = $event) : null\"\n    :extensions=\"[PreserveVideoControls]\"\n  >\n    <template #bottom>\n      <div v-if=\"editable\" class=\"flex flex-col gap-2\">\n        <div class=\"flex flex-wrap gap-2 px-10\">\n          <AttachmentItem\n            v-for=\"a in attachments\"\n            :key=\"a.file_url\"\n            :label=\"a.file_name\"\n          >\n            <template #suffix>\n              <FeatherIcon\n                class=\"h-3.5\"\n                name=\"x\"\n                @click.stop=\"removeAttachment(a)\"\n              />\n            </template>\n          </AttachmentItem>\n        </div>\n        <div\n          class=\"flex justify-between gap-2 overflow-hidden border-t px-10 py-2.5\"\n        >\n          <div class=\"flex items-center overflow-x-auto\">\n            <TextEditorFixedMenu\n              class=\"-ml-1\"\n              :buttons=\"textEditorMenuButtons\"\n            />\n            <FileUploader\n              :upload-args=\"{\n                doctype: doctype,\n                docname: modelValue.name,\n                private: true,\n              }\"\n              @success=\"(f) => attachments.push(f)\"\n            >\n              <template #default=\"{ openFileSelector }\">\n                <Button\n                  theme=\"gray\"\n                  variant=\"ghost\"\n                  @click=\"openFileSelector()\"\n                >\n                  <template #icon>\n                    <AttachmentIcon\n                      class=\"h-4\"\n                      style=\"color: #000000; stroke-width: 1.5 !important\"\n                    />\n                  </template>\n                </Button>\n              </template>\n            </FileUploader>\n          </div>\n          <div class=\"mt-2 flex items-center justify-end space-x-2 sm:mt-0\">\n            <Button\n              label=\"Discard\"\n              @click=\"\n                () => {\n                  newComment = '';\n                  attachments = [];\n                  emit('discard');\n                }\n              \"\n            />\n            <Button\n              variant=\"solid\"\n              label=\"Comment\"\n              :disabled=\"commentEmpty\"\n              :loading=\"loading\"\n              @click=\"\n                () => {\n                  loading = true;\n                  submitComment();\n                  newComment = '';\n                }\n              \"\n            />\n          </div>\n        </div>\n      </div>\n    </template>\n  </TextEditor>\n</template>\n<script setup lang=\"ts\">\nimport { computed, ref, onMounted } from \"vue\";\nimport {\n  TextEditorFixedMenu,\n  TextEditor,\n  FileUploader,\n  createResource,\n} from \"frappe-ui\";\n\nimport { AttachmentIcon } from \"@/components/icons/\";\nimport { AttachmentItem } from \"@/components/\";\nimport { useAgentStore } from \"@/stores/agent\";\nimport { useStorage } from \"@vueuse/core\";\nimport { PreserveVideoControls } from \"@/tiptap-extensions\";\nimport { isContentEmpty, textEditorMenuButtons, getFontFamily } from \"@/utils\";\n\nconst { agents: agentsList } = useAgentStore();\nonMounted(() => {\n  agentsList.fetch();\n});\nconst props = defineProps({\n  placeholder: {\n    type: String,\n    default: null,\n  },\n  editable: {\n    type: Boolean,\n    default: true,\n  },\n  doctype: {\n    type: String,\n    default: \"HD Ticket\",\n  },\n});\n\nconst emit = defineEmits([\"submit\", \"discard\"]);\nconst doc = defineModel();\nconst newComment = useStorage(\"commentBoxContent\" + doc.value.name, \"\");\nconst attachments = ref([]);\nconst commentEmpty = computed(() => {\n  return isContentEmpty(newComment.value);\n});\nconst loading = ref(false);\n\nconst agents = computed(() => {\n  return (\n    agentsList.data?.map((agent) => ({\n      label: agent.agent_name.trimEnd(),\n      value: agent.name,\n    })) || []\n  );\n});\n\nfunction removeAttachment(attachment) {\n  attachments.value = attachments.value.filter((a) => a !== attachment);\n}\n\nasync function submitComment() {\n  if (isContentEmpty(newComment.value)) {\n    return;\n  }\n  const comment = createResource({\n    url: \"run_doc_method\",\n    makeParams: () => ({\n      dt: props.doctype,\n      dn: doc.value.name,\n      method: \"new_comment\",\n      args: {\n        content: newComment.value,\n        attachments: attachments.value,\n      },\n    }),\n    onSuccess: () => {\n      emit(\"submit\");\n      loading.value = false;\n      attachments.value = [];\n      newComment.value = null;\n    },\n    onError: () => {\n      loading.value = false;\n    },\n  });\n\n  comment.submit();\n}\ndefineExpose({\n  submitComment,\n});\n</script>\n","<template>\n  <div>\n    <div class=\"flex flex-wrap gap-1\">\n      <Button\n        v-for=\"value in values\"\n        ref=\"emails\"\n        :key=\"value\"\n        :label=\"value\"\n        theme=\"gray\"\n        variant=\"subtle\"\n        class=\"rounded-full\"\n        @keydown.delete.capture.stop=\"removeLastValue\"\n      >\n        <template #suffix>\n          <FeatherIcon\n            class=\"h-3.5\"\n            name=\"x\"\n            @click.stop=\"removeValue(value)\"\n          />\n        </template>\n      </Button>\n      <div class=\"flex-1\">\n        <Combobox v-model=\"selectedValue\" nullable>\n          <Popover v-model:show=\"showOptions\" class=\"w-full\">\n            <template #target=\"{ togglePopover }\">\n              <ComboboxInput\n                ref=\"search\"\n                class=\"search-input form-input w-full border-none bg-white hover:bg-white focus:border-none focus:!shadow-none focus-visible:!ring-0\"\n                type=\"text\"\n                :value=\"query\"\n                autocomplete=\"off\"\n                @change=\"\n                  (e) => {\n                    query = e.target.value;\n                    showOptions = true;\n                  }\n                \"\n                @focus=\"() => togglePopover()\"\n                @keydown.delete.capture.stop=\"removeLastValue\"\n              />\n            </template>\n            <template #body=\"{ isOpen }\">\n              <div v-show=\"isOpen\">\n                <div class=\"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl\">\n                  <ComboboxOptions\n                    class=\"my-1 max-h-[12rem] overflow-y-auto px-1.5\"\n                    static\n                  >\n                    <ComboboxOption\n                      v-for=\"option in options\"\n                      :key=\"option.value\"\n                      v-slot=\"{ active }\"\n                      :value=\"option\"\n                    >\n                      <li\n                        :class=\"[\n                          'flex cursor-pointer items-center rounded px-2 py-1 text-base',\n                          { 'bg-gray-100': active },\n                        ]\"\n                      >\n                        <UserAvatar\n                          class=\"mr-2\"\n                          :name=\"option.value\"\n                          size=\"lg\"\n                        />\n                        <div class=\"flex flex-col gap-1 p-1 text-gray-800\">\n                          <div class=\"text-base font-medium\">\n                            {{ option.label }}\n                          </div>\n                          <div class=\"text-sm text-gray-600\">\n                            {{ option.value }}\n                          </div>\n                        </div>\n                      </li>\n                    </ComboboxOption>\n                  </ComboboxOptions>\n                </div>\n              </div>\n            </template>\n          </Popover>\n        </Combobox>\n      </div>\n    </div>\n    <ErrorMessage v-if=\"error\" class=\"mt-2 pl-2\" :message=\"error\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  Combobox,\n  ComboboxInput,\n  ComboboxOptions,\n  ComboboxOption,\n} from \"@headlessui/vue\";\nimport { UserAvatar } from \"@/components/\";\nimport { Popover, createResource } from \"frappe-ui\";\nimport { ref, computed, nextTick } from \"vue\";\nimport { watchDebounced } from \"@vueuse/core\";\n\nconst props = defineProps({\n  validate: {\n    type: Function,\n    default: null,\n  },\n  errorMessage: {\n    type: Function,\n    default: (value) => `${value} is an Invalid value`,\n  },\n});\n\nconst values = defineModel();\n\nconst emails = ref([]);\nconst search = ref(null);\nconst error = ref(null);\nconst query = ref(\"\");\nconst text = ref(\"\");\nconst showOptions = ref(false);\n\nconst selectedValue = computed({\n  get: () => query.value || \"\",\n  set: (val) => {\n    query.value = \"\";\n    if (val) {\n      showOptions.value = false;\n    }\n    val?.value && addValue(val.value);\n  },\n});\n\nwatchDebounced(\n  query,\n  (val) => {\n    val = val || \"\";\n    if (text.value === val) return;\n    text.value = val;\n    reload(val);\n  },\n  { debounce: 300, immediate: true }\n);\n\nconst filterOptions = createResource({\n  url: \"frappe.desk.search.search_link\",\n  method: \"POST\",\n  cache: [text.value, \"Contact\"],\n  params: {\n    txt: text.value,\n    doctype: \"Contact\",\n  },\n  transform: (data) => {\n    let allData = data\n      .filter((c) => {\n        return c.description.split(\", \")[1];\n      })\n      .map((option) => {\n        let email = option.description.split(\", \")[1];\n        return {\n          label: option.label || email,\n          value: email,\n        };\n      });\n    return allData;\n  },\n});\n\nconst options = computed(() => {\n  let searchedContacts = filterOptions.data || [];\n  if (!searchedContacts.length && query.value) {\n    searchedContacts.push({\n      label: query.value,\n      value: query.value,\n    });\n  }\n  return searchedContacts;\n});\n\nfunction reload(val) {\n  filterOptions.update({\n    params: {\n      txt: val,\n      doctype: \"Contact\",\n    },\n  });\n  filterOptions.reload();\n}\n\nconst addValue = (value) => {\n  error.value = null;\n  if (value) {\n    const splitValues = value.split(\",\");\n    splitValues.forEach((value) => {\n      value = value.trim();\n      if (value) {\n        // check if value is not already in the values array\n        if (!values.value?.includes(value)) {\n          // check if value is valid\n          if (value && props.validate && !props.validate(value)) {\n            error.value = props.errorMessage(value);\n            return;\n          }\n          // add value to values array\n          if (!values.value) {\n            values.value = [value];\n          } else {\n            values.value.push(value);\n          }\n          value = value.replace(value, \"\");\n        }\n      }\n    });\n    !error.value && (value = \"\");\n  }\n};\n\nconst removeValue = (value) => {\n  values.value = values.value.filter((v) => v !== value);\n};\n\nconst removeLastValue = () => {\n  if (query.value) return;\n\n  let emailRef = emails.value[emails.value.length - 1]?.$el;\n  if (document.activeElement === emailRef) {\n    values.value.pop();\n    nextTick(() => {\n      if (values.value.length) {\n        emailRef = emails.value[emails.value.length - 1].$el;\n        emailRef?.focus();\n      } else {\n        setFocus();\n      }\n    });\n  } else {\n    emailRef?.focus();\n  }\n};\n\nfunction setFocus() {\n  search.value.$el.focus();\n}\n\ndefineExpose({ setFocus });\n</script>\n","<template>\n  <div class=\"flex flex-col comm-area\">\n    <div\n      class=\"flex justify-between gap-3 border-t px-4 lg:px-10 py-4 md:py-2.5\"\n    >\n      <div class=\"flex gap-1.5\">\n        <Button\n          ref=\"sendEmailRef\"\n          variant=\"ghost\"\n          label=\"Reply\"\n          :class=\"[showEmailBox ? '!bg-gray-300 hover:!bg-gray-200' : '']\"\n          @click=\"toggleEmailBox()\"\n        >\n          <template #prefix>\n            <EmailIcon class=\"h-4\" />\n          </template>\n        </Button>\n        <Button\n          variant=\"ghost\"\n          label=\"Comment\"\n          :class=\"[showCommentBox ? '!bg-gray-300 hover:!bg-gray-200' : '']\"\n          @click=\"toggleCommentBox()\"\n        >\n          <template #prefix>\n            <CommentIcon class=\"h-4\" />\n          </template>\n        </Button>\n      </div>\n    </div>\n    <div\n      v-show=\"showCommentBox\"\n      @keydown.ctrl.enter.capture.stop=\"submitComment\"\n      @keydown.meta.enter.capture.stop=\"submitComment\"\n    >\n      <CommentTextEditor\n        ref=\"commentTextEditorRef\"\n        v-model=\"doc\"\n        :editable=\"showCommentBox\"\n        :doctype=\"doctype\"\n        placeholder=\"@John could you please look into this?\"\n        @submit=\"\n          () => {\n            showCommentBox = false;\n            emit('update');\n          }\n        \"\n        @discard=\"\n          () => {\n            showCommentBox = false;\n          }\n        \"\n      />\n    </div>\n    <div\n      v-show=\"showEmailBox\"\n      class=\"flex gap-1.5\"\n      @keydown.ctrl.enter.capture.stop=\"submitEmail\"\n      @keydown.meta.enter.capture.stop=\"submitEmail\"\n    >\n      <EmailEditor\n        ref=\"emailEditorRef\"\n        v-model=\"doc\"\n        v-model:content=\"content\"\n        placeholder=\"Hi John, we are looking into this issue.\"\n        :to-emails=\"toEmails\"\n        :cc-emails=\"ccEmails\"\n        :bcc-emails=\"bccEmails\"\n        @submit=\"\n          () => {\n            showEmailBox = false;\n            emit('update');\n          }\n        \"\n        @discard=\"\n          () => {\n            showEmailBox = false;\n          }\n        \"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\n\nimport { EmailEditor, CommentTextEditor } from \"@/components\";\nimport { EmailIcon, CommentIcon } from \"@/components/icons/\";\n\nconst emit = defineEmits([\"update\"]);\nconst content = defineModel(\"content\");\nconst doc = defineModel();\n\nconst showEmailBox = ref(false);\nconst showCommentBox = ref(false);\n\nconst emailEditorRef = ref(null);\nconst commentTextEditorRef = ref(null);\n\nfunction toggleEmailBox() {\n  if (showCommentBox.value) {\n    showCommentBox.value = false;\n  }\n  showEmailBox.value = !showEmailBox.value;\n}\n\nfunction toggleCommentBox() {\n  if (showEmailBox.value) {\n    showEmailBox.value = false;\n  }\n  showCommentBox.value = !showCommentBox.value;\n}\n\nfunction submitEmail() {\n  emailEditorRef.value.submitMail();\n  emit(\"update\");\n}\n\nfunction submitComment() {\n  commentTextEditorRef.value.submitComment();\n  emit(\"update\");\n}\n\nfunction replyToEmail(data: object) {\n  showEmailBox.value = true;\n  emailEditorRef.value.addToReply(\n    data.content,\n    data.to?.split(\",\"),\n    data.cc?.split(\",\"),\n    data.bcc?.split(\",\")\n  );\n}\n\nfunction forwardEmail(data: object) {\n  showEmailBox.value = true;\n  emailEditorRef.value.addToForward(\n    data.content,\n    data.subject,\n    data.attachments\n  );\n}\n\nconst props = defineProps({\n  doctype: {\n    type: String,\n    default: \"HD Ticket\",\n  },\n  toEmails: {\n    type: Array,\n    default: () => [],\n  },\n  ccEmails: {\n    type: Array,\n    default: () => [],\n  },\n  bccEmails: {\n    type: Array,\n    default: () => [],\n  },\n});\n\ndefineExpose({\n  replyToEmail,\n  forwardEmail,\n  toggleEmailBox,\n  toggleCommentBox,\n  editor: emailEditorRef,\n});\n</script>\n\n<style>\n@media screen and (max-width: 640px) {\n  .comm-area {\n    width: 100vw;\n  }\n}\n</style>\n","<template>\n  <Dialog :options=\"{ title: `Split ticket` }\" v-model=\"showDialog\">\n    <template #body-content>\n      <div class=\"flex flex-col gap-4\">\n        <p class=\"text-p-base text-ink-gray-8\">\n          All\n          <span class=\"underline\">emails/ comments</span>\n          from this email onwards will be moved to new ticket.\n        </p>\n        <FormControl\n          label=\"New Ticket Subject\"\n          type=\"text\"\n          v-model=\"subject\"\n          placeholder=\"Add a subject for the new ticket\"\n        />\n        <div\n          class=\"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200\"\n        >\n          <TriangleAlert\n            class=\"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-yellow-500\"\n          />\n\n          <div class=\"text-wrap text-sm text-gray-700\">\n            This action is irreversible.\n          </div>\n        </div>\n      </div>\n    </template>\n    <template #actions>\n      <Button\n        class=\"w-full\"\n        variant=\"solid\"\n        label=\"Split into new ticket\"\n        :loading=\"splitTicket.loading\"\n        :icon-left=\"LucideSplit\"\n        @click=\"handleTicketSplit\"\n      />\n    </template>\n  </Dialog>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nimport { Dialog, createResource } from \"frappe-ui\";\nimport { createToast } from \"@/utils\";\nimport LucideSplit from \"~icons/lucide/split\";\nimport TriangleAlert from \"~icons/lucide/triangle-alert\";\n\ninterface Props {\n  ticket_id: string;\n  communication_id: string;\n}\n\ninterface E {\n  (event: \"update\"): void;\n  //   (event: \"rowClick\", row: any): void;\n}\n\nconst props = defineProps<Props>();\nconst emit = defineEmits<E>();\nconst showDialog = defineModel<boolean>();\n\nconst subject = ref(null);\n\nconst splitTicket = createResource({\n  url: \"helpdesk.helpdesk.doctype.hd_ticket.api.split_ticket\",\n  makeParams({ subject, communication_id }) {\n    return {\n      subject,\n      communication_id,\n    };\n  },\n  validate({ subject, communication_id }) {\n    if (!subject) throw { message: \"Subject is required\" };\n    if (!communication_id) throw { message: \"Communication ID is required\" };\n  },\n  onSuccess: (newTicket: string) => {\n    createToast({\n      title: \"Ticket split successfully\",\n      icon: \"check\",\n      iconClasses: \"text-green-600\",\n    });\n    showDialog.value = false;\n    window.open(\n      window.location.origin + \"/helpdesk/tickets/\" + newTicket,\n      \"_blank\"\n    );\n    window.location.reload();\n  },\n});\n\nfunction handleTicketSplit() {\n  splitTicket.submit({\n    subject: subject.value,\n    communication_id: props.communication_id,\n  });\n}\n</script>\n\n<style scoped></style>\n","<template>\n  <div\n    v-bind=\"$attrs\"\n    class=\"grow cursor-pointer border-transparent bg-white rounded-md shadow text-base leading-6 transition-all duration-300 ease-in-out\"\n  >\n    <div class=\"mb-1 flex items-center justify-between gap-2\">\n      <!-- email design for mobile -->\n      <div v-if=\"isMobileView\" class=\"flex items-center gap-2 text-sm\">\n        <div class=\"leading-tight\">\n          <p>{{ sender.full_name || \"No name found\" }}</p>\n          <Tooltip :text=\"dateFormat(creation, dateTooltipFormat)\">\n            <p class=\"text-xs md:text-sm text-gray-600\">\n              {{ timeAgo(creation) }}\n            </p>\n          </Tooltip>\n          <p class=\"sm:flex hidden text-sm text-gray-600\" v-if=\"sender.name\">\n            {{ \"<\" + sender.name + \">\" }}\n          </p>\n        </div>\n      </div>\n      <!-- email design for desktop -->\n      <div v-else class=\"flex items-center gap-2\">\n        <span>{{ sender.full_name || \"No name found\" }}</span>\n        <span class=\"sm:flex hidden text-sm text-gray-600\" v-if=\"sender.name\">{{\n          \"<\" + sender.name + \">\"\n        }}</span>\n      </div>\n\n      <div class=\"flex gap-0.5 items-center\">\n        <Tooltip\n          :text=\"dateFormat(creation, dateTooltipFormat)\"\n          v-if=\"!isMobileView\"\n        >\n          <p class=\"text-xs md:text-sm text-gray-600\">\n            {{ timeAgo(creation) }}\n          </p>\n        </Tooltip>\n        <Button\n          variant=\"ghost\"\n          class=\"text-gray-700\"\n          @click=\"\n            emit('reply', {\n              content: content,\n              to: sender?.name ?? to,\n            })\n          \"\n        >\n          <ReplyIcon class=\"h-4 w-4\" />\n        </Button>\n        <Button\n          variant=\"ghost\"\n          class=\"text-gray-700\"\n          @click=\"\n            emit('reply', {\n              content: content,\n              to: sender?.name ?? to,\n              cc: cc,\n              bcc: bcc,\n            })\n          \"\n        >\n          <ReplyAllIcon class=\"h-4 w-4\" />\n        </Button>\n        <Dropdown\n          :options=\"[\n            ...(showSplitOption ? [{\n              label: 'Split Ticket',\n              icon: LucideSplit,\n              onClick: () => (showSplitModal = true),\n            }] : []),\n            {\n              label: 'Forward',\n              icon: ForwardIcon,\n              onClick: () => emit('forward', {\n                content: content,\n                attachments: attachments,\n                subject: subject,\n                to: sender?.name ?? to,\n                cc: cc,\n                bcc: bcc,\n              }),\n            },\n          ]\"\n        >\n          <Button\n            icon=\"more-horizontal\"\n            class=\"text-gray-600\"\n            variant=\"ghost\"\n          />\n        </Dropdown>\n      </div>\n    </div>\n    <!-- <div class=\"text-sm leading-5 text-gray-600\">\n      {{ subject }}\n    </div> -->\n    <div class=\"mb-3 text-sm leading-5 text-gray-600\">\n      <span v-if=\"to\" class=\"text-2xs mr-1 font-bold text-gray-500\">TO:</span>\n      <span v-if=\"to\"> {{ to }} </span>\n      <span v-if=\"cc\">, </span>\n      <span v-if=\"cc\" class=\"text-2xs mr-1 font-bold text-gray-500\"> CC: </span>\n      <span v-if=\"cc\">{{ cc }}</span>\n      <span v-if=\"bcc\">, </span>\n      <span v-if=\"bcc\" class=\"text-2xs mr-1 font-bold text-gray-500\">\n        BCC:\n      </span>\n      <span v-if=\"bcc\">{{ bcc }}</span>\n    </div>\n    <EmailContent :content=\"content\" />\n    <div class=\"flex flex-wrap gap-2\">\n      <AttachmentItem\n        v-for=\"a in attachments\"\n        :key=\"a.file_url\"\n        :label=\"a.file_name\"\n        :url=\"a.file_url\"\n      />\n    </div>\n  </div>\n  <TicketSplitModal\n    v-model=\"showSplitModal\"\n    :ticket_id=\"name\"\n    :communication_id=\"name\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nimport { AttachmentItem } from \"@/components\";\nimport { dateFormat, timeAgo, dateTooltipFormat } from \"@/utils\";\nimport LucideSplit from \"~icons/lucide/split\";\nimport { ReplyIcon, ReplyAllIcon, ForwardIcon } from \"./icons\";\nimport { useScreenSize } from \"@/composables/screen\";\nimport TicketSplitModal from \"./ticket/TicketSplitModal.vue\";\n\nconst props = defineProps({\n  activity: {\n    type: Object,\n    required: true,\n  },\n  showSplitOption: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst { sender, to, cc, bcc, creation, subject, attachments, content, name } =\n  props.activity;\n\nconst emit = defineEmits([\"reply\",\"forward\"]);\n\nconst { isMobileView } = useScreenSize();\n\nconst showSplitModal = ref(false);\n\n// TODO: Implement reply functionality using this way instead of emit drillup\n// function reply(email, reply_all = false) {\n//   emailBox.toggleEmailBox();\n//   let editor = emailBox.editor;\n//   let message = email.content;\n//   let recipients = sender.name;\n//   editor.toEmails = [email.sender];\n//   editor.cc = editor.bcc = false;\n//   editor.ccEmails = [];\n//   editor.bccEmails = [];\n//   console.log(recipients);\n\n//   if (!email.subject.startsWith(\"Re:\")) {\n//     editor.subject = `Re: ${email.subject}`;\n//   } else {\n//     editor.subject = email.subject;\n//   }\n\n//   if (reply_all) {\n//     let cc = email.cc?.split(\",\").map((r) => r.trim());\n//     let bcc = email.bcc?.split(\",\").map((r) => r.trim());\n\n//     if (cc?.length) {\n//       recipients = recipients.filter((r) => !cc?.includes(r));\n//       cc.push(...recipients);\n//     } else {\n//       cc = recipients;\n//     }\n\n//     editor.cc = cc ? true : false;\n//     editor.bcc = bcc ? true : false;\n\n//     editor.ccEmails = cc;\n//     editor.bccEmails = bcc;\n//   }\n\n//   let repliedMessage = `<blockquote>${message}</blockquote>`;\n\n//   editor.editor\n//     .chain()\n//     .clearContent()\n//     .insertContent(\"<p>.</p>\")\n//     .updateAttributes(\"paragraph\", { class: \"reply-to-content\" })\n//     .insertContent(repliedMessage)\n//     .focus(\"all\")\n//     .insertContentAt(0, { type: \"paragraph\" })\n//     .focus(\"start\")\n//     .run();\n// }\n</script>\n\n<style>\n.email-content {\n  max-width: 100%;\n}\n.email-content > * {\n  display: flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n}\n</style>\n","<template>\n  <div class=\"flex-col text-base flex-1\" ref=\"commentBoxRef\">\n    <div class=\"mb-1 ml-0.5 flex items-center justify-between\">\n      <div class=\"text-gray-600 flex items-center gap-2\">\n        <Avatar\n          size=\"sm\"\n          :label=\"commenter\"\n          :image=\"getUser(commentedBy).user_image\"\n        />\n        <p>\n          <span class=\"font-medium text-gray-800\">\n            {{ commenter }}\n          </span>\n          <span> added a</span>\n          <span class=\"max-w-xs truncate font-medium text-gray-800\">\n            comment\n          </span>\n        </p>\n      </div>\n      <div class=\"flex items-center gap-1\">\n        <Tooltip :text=\"dateFormat(creation, dateTooltipFormat)\">\n          <span class=\"pl-0.5 text-sm text-gray-600\">\n            {{ timeAgo(creation) }}\n          </span>\n        </Tooltip>\n        <div v-if=\"authStore.userId === commentedBy && !editable\">\n          <Dropdown\n            :options=\"[\n              {\n                label: 'Edit',\n                onClick: () => handleEditMode(),\n                icon: 'edit-2',\n                condition: () => !isTicketMergedComment,\n              },\n              {\n                label: 'Delete',\n                onClick: () => (showDialog = true),\n                icon: 'trash-2',\n              },\n            ]\"\n          >\n            <Button\n              icon=\"more-horizontal\"\n              class=\"text-gray-600\"\n              variant=\"ghost\"\n            />\n          </Dropdown>\n        </div>\n      </div>\n    </div>\n    <div class=\"rounded bg-gray-50 px-4 py-3\">\n      <TextEditor\n        ref=\"editorRef\"\n        :editor-class=\"[\n          'prose-f shrink  text-p-sm transition-all duration-300 ease-in-out block w-full content',\n          getFontFamily(_content),\n        ]\"\n        :content=\"_content\"\n        :editable=\"editable\"\n        :bubble-menu=\"textEditorMenuButtons\"\n        @change=\"(event:string) => {_content = event}\"\n      >\n        <template #bottom v-if=\"editable\">\n          <div class=\"flex flex-row-reverse gap-2\">\n            <Button label=\"Save\" @click=\"handleSaveComment\" variant=\"solid\" />\n            <Button label=\"Discard\" @click=\"handleDiscard\" />\n          </div>\n        </template>\n      </TextEditor>\n      <div class=\"flex flex-wrap gap-2\" v-if=\"!editable\">\n        <AttachmentItem\n          v-for=\"a in attachments\"\n          :key=\"a.file_url\"\n          :label=\"a.file_name\"\n          :url=\"a.file_url\"\n        />\n      </div>\n    </div>\n  </div>\n  <Dialog\n    v-model=\"showDialog\"\n    :options=\"{\n      title: 'Delete Comment',\n      message: 'Are you sure you want to confirm this action?',\n      actions: [\n        { label: 'Cancel', onClick: () => (showDialog = false) },\n        {\n          label: 'Delete',\n          onClick: () => deleteComment.submit(),\n          variant: 'solid',\n        },\n      ],\n    }\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, PropType, onMounted, computed } from \"vue\";\nimport {\n  Dropdown,\n  createResource,\n  Dialog,\n  Avatar,\n  TextEditor,\n} from \"frappe-ui\";\nimport {\n  dateFormat,\n  timeAgo,\n  dateTooltipFormat,\n  createToast,\n  textEditorMenuButtons,\n  isContentEmpty,\n  getFontFamily,\n} from \"@/utils\";\nimport { AttachmentItem } from \"@/components\";\nimport { useAuthStore } from \"@/stores/auth\";\nimport { useUserStore } from \"@/stores/user\";\nimport { CommentActivity } from \"@/types\";\nimport { updateRes as updateComment } from \"@/stores/knowledgeBase\";\nconst authStore = useAuthStore();\nconst props = defineProps({\n  activity: {\n    type: Object as PropType<CommentActivity>,\n    required: true,\n  },\n});\nconst { getUser } = useUserStore();\n\nconst { name, creation, content, commenter, commentedBy, attachments } =\n  props.activity;\n\nconst isTicketMergedComment = computed(() => {\n  const regex = /has been merged with ticket #\\d+/;\n  return regex.test(content);\n});\n\nconst emit = defineEmits([\"update\"]);\nconst showDialog = ref(false);\nconst editable = ref(false);\nconst _content = ref(content);\n\n// HTML refs\nconst commentBoxRef = ref(null);\nconst editorRef = ref(null);\n\nfunction handleEditMode() {\n  editable.value = true;\n  editorRef.value.editor.chain().focus(\"start\");\n}\n\nfunction handleDiscard() {\n  _content.value = content;\n  editable.value = false;\n}\n\nconst deleteComment = createResource({\n  url: \"frappe.client.delete\",\n  makeParams: () => ({\n    doctype: \"HD Ticket Comment\",\n    name: name,\n  }),\n  onSuccess() {\n    emit(\"update\");\n    createToast({\n      title: \"Comment deleted\",\n      icon: \"check\",\n      iconClasses: \"text-green-500\",\n    });\n  },\n});\n\nfunction handleSaveComment() {\n  if (content === _content.value) {\n    editable.value = false;\n    return;\n  }\n  if (isContentEmpty(_content.value)) {\n    createToast({\n      title: \"Comment cannot be empty\",\n      icon: \"x\",\n      iconClasses: \"text-red-600\",\n    });\n    return;\n  }\n\n  updateComment.submit(\n    {\n      doctype: \"HD Ticket Comment\",\n      name: name,\n      fieldname: \"content\",\n      value: _content.value,\n    },\n    {\n      onSuccess: () => {\n        editable.value = false;\n        emit(\"update\");\n        createToast({\n          title: \"Comment updated\",\n          icon: \"check\",\n          iconClasses: \"text-green-500\",\n        });\n      },\n    }\n  );\n}\n\nonMounted(() => {\n  commentBoxRef.value.style.width = \"0px\";\n});\n</script>\n","<template>\n  <div class=\"flex-1\">\n    <div class=\"mt-1.5 flex justify-between text-base items-center\">\n      <div class=\"text-gray-600\">\n        <span class=\"font-medium text-gray-800\">\n          {{ user }}\n        </span>\n        <span> {{ content }}</span>\n      </div>\n      <Tooltip :text=\"dateFormat(creation, dateTooltipFormat)\">\n        <div class=\"text-gray-600 text-sm\">\n          {{ timeAgo(creation) }}\n        </div>\n      </Tooltip>\n    </div>\n    <div v-if=\"show_others && content !== 'created this ticket'\">\n      <div\n        v-for=\"relatedActivity in relatedActivities\"\n        :key=\"relatedActivity.creation\"\n        class=\"mt-2 flex justify-between text-base\"\n      >\n        <div class=\"text-gray-600\">\n          <span class=\"font-medium text-gray-800\">\n            {{ relatedActivity.user }}\n          </span>\n          <span> {{ relatedActivity.content }}</span>\n        </div>\n        <Tooltip\n          :text=\"dateFormat(relatedActivity.creation, dateTooltipFormat)\"\n        >\n          <div class=\"text-gray-600 text-sm\">\n            {{ timeAgo(relatedActivity.creation) }}\n          </div>\n        </Tooltip>\n      </div>\n    </div>\n    <Button\n      v-if=\"relatedActivities.length && content !== 'created this ticket'\"\n      :label=\"\n        show_others ? 'Hide' : `${relatedActivities.length} other activities`\n      \"\n      variant=\"outline\"\n      class=\"mt-2\"\n      @click=\"show_others = !show_others\"\n    >\n      <template #suffix>\n        <FeatherIcon\n          :name=\"show_others ? 'chevron-up' : 'chevron-down'\"\n          class=\"h-4 text-gray-600\"\n        />\n      </template>\n    </Button>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nimport { dateFormat, timeAgo, dateTooltipFormat } from \"@/utils\";\n\nconst props = defineProps({\n  activity: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst { user, content, creation, relatedActivities } = props.activity;\n\nlet show_others = ref(false);\n</script>\n","<template>\n  <Dialog\n    v-model=\"show\"\n    :options=\"{\n      title: 'Assign To',\n      size: 'xl',\n    }\"\n  >\n    <template #body-content>\n      <SearchComplete\n        class=\"form-control\"\n        doctype=\"HD Agent\"\n        :custom-filters=\"customFilters\"\n        :reset-input=\"true\"\n        @change=\"\n          (option) => {\n            addAssignee(option.value);\n          }\n        \"\n      >\n        <template #item-prefix=\"{ option }\">\n          <UserAvatar class=\"mr-2\" :name=\"option.value\" size=\"sm\" />\n        </template>\n        <template #item-label=\"{ option }\">\n          <Tooltip :text=\"option.value\">\n            {{ getUser(option.value).full_name }}\n          </Tooltip>\n        </template>\n      </SearchComplete>\n      <div class=\"mt-3 flex flex-wrap items-center gap-2\">\n        <Tooltip\n          v-for=\"currentAssignee in assignees\"\n          :key=\"currentAssignee.name\"\n          :text=\"currentAssignee.name\"\n        >\n          <Button\n            :label=\"getUser(currentAssignee.name).full_name\"\n            theme=\"gray\"\n            variant=\"outline\"\n          >\n            <template #prefix>\n              <UserAvatar :name=\"currentAssignee.name\" size=\"sm\" />\n            </template>\n            <template #suffix>\n              <FeatherIcon\n                class=\"h-3.5\"\n                name=\"x\"\n                @click.stop=\"removeCurrentAssignee(currentAssignee.name)\"\n              />\n            </template>\n          </Button>\n        </Tooltip>\n      </div>\n      <ErrorMessage v-if=\"error\" class=\"mt-2\" :message=\"error\" />\n    </template>\n  </Dialog>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from \"vue\";\nimport { createResource } from \"frappe-ui\";\nimport { UserAvatar, SearchComplete } from \"@/components\";\nimport { useUserStore } from \"@/stores/user\";\n\nconst props = defineProps({\n  assignees: {\n    type: Array,\n    required: true,\n  },\n  doctype: {\n    type: String,\n    required: true,\n  },\n  docname: {\n    type: String,\n    required: true,\n  },\n});\n\nconst show = defineModel();\n\nconst emit = defineEmits([\"update\"]);\n\nconst { getUser } = useUserStore();\n\nconst error = ref(\"\");\n\nconst addAssignee = (value) => {\n  error.value = \"\";\n  createResource({\n    url: \"frappe.desk.form.assign_to.add\",\n    auto: true,\n    params: {\n      doctype: props.doctype,\n      name: props.docname,\n      assign_to: [value],\n    },\n    onSuccess: () => {\n      emit(\"update\");\n    },\n  });\n  emit(\"update\");\n};\n\nconst removeCurrentAssignee = (value) => {\n  createResource({\n    url: \"frappe.desk.form.assign_to.remove\",\n    auto: true,\n    params: {\n      doctype: props.doctype,\n      name: props.docname,\n      assign_to: value,\n    },\n    onSuccess: () => {\n      emit(\"update\");\n    },\n  });\n};\n\nconst customFilters = computed(() => {\n  const filters = {};\n  filters[\"is_active\"] = [\"=\", 1];\n  if (Boolean(props.assignees?.length)) {\n    filters[\"name\"] = [\"not in\", [...props.assignees.map((a) => a.name)]];\n  }\n  return filters;\n});\n</script>\n","<template>\n  <Dialog\n    v-model=\"show\"\n    :options=\"{\n      title: 'Canned Responses',\n      size: '4xl',\n    }\"\n  >\n    <template #body-content>\n      <TextInput\n        ref=\"searchInput\"\n        v-model=\"search\"\n        type=\"text\"\n        :placeholder=\"'Site Down'\"\n      >\n        <template #prefix>\n          <FeatherIcon name=\"search\" class=\"h-4 w-4 text-gray-500\" />\n        </template>\n      </TextInput>\n      <div\n        v-if=\"filteredTemplates.length\"\n        class=\"mt-2 grid max-h-[560px] grid-cols-1 md:grid-cols-3 gap-2 overflow-y-auto\"\n      >\n        <div\n          v-for=\"template in filteredTemplates\"\n          :key=\"template.name\"\n          class=\"flex h-56 cursor-pointer flex-col gap-2 rounded-lg border p-3 hover:bg-gray-100\"\n          @click=\"emit('apply', template)\"\n        >\n          <div class=\"border-b pb-2 text-base font-semibold\">\n            {{ template.title }}\n          </div>\n          <TextEditor\n            v-if=\"template.message\"\n            :content=\"template.message\"\n            :editable=\"false\"\n            editor-class=\"!prose-sm max-w-none !text-sm text-gray-600 focus:outline-none\"\n            class=\"flex-1 overflow-hidden\"\n          />\n        </div>\n      </div>\n      <div v-else class=\"mt-2\">\n        <div class=\"flex h-56 flex-col items-center justify-center\">\n          <div class=\"text-lg text-gray-500\">\n            {{ \"No templates found\" }}\n          </div>\n        </div>\n      </div>\n      <div class=\"flex justify-end mt-4\">\n        <Button\n          label=\"New Canned Response\"\n          @click=\"\n            () => {\n              $router.push('/canned-responses#new');\n              templates.data = null;\n            }\n          \"\n        />\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script setup>\nimport { TextEditor, createListResource } from \"frappe-ui\";\nimport { ref, computed, nextTick, watch, onMounted } from \"vue\";\n\nconst props = defineProps({\n  doctype: {\n    type: String,\n    default: \"\",\n  },\n});\n\nconst show = defineModel();\nconst searchInput = ref(\"\");\n\nconst emit = defineEmits([\"apply\"]);\n\nconst search = ref(\"\");\n\nconst templates = createListResource({\n  type: \"list\",\n  doctype: \"HD Canned Response\",\n  cache: [\"cannedResponses\", props.doctype],\n  fields: [\"title\", \"message\", \"modified\"],\n  orderBy: \"modified desc\",\n  pageLength: 99999,\n});\n\nonMounted(() => {\n  if (templates.data == null) {\n    templates.fetch();\n  }\n});\n\nconst filteredTemplates = computed(() => {\n  return (\n    templates.data?.filter((template) => {\n      return template.title.toLowerCase().includes(search.value.toLowerCase());\n    }) ?? []\n  );\n});\n\nwatch(show, (value) => value && nextTick(() => searchInput.value?.el?.focus()));\n</script>\n","<template>\n  <div class=\"flex items-center justify-start gap-5 border-b p-5\">\n    <Avatar size=\"3xl\" :image=\"contact.image\" :label=\"contact.name\" />\n    <div class=\"flex items-center justify-between flex-1\">\n      <Tooltip :text=\"contact.name\">\n        <div class=\"w-[242px] truncate text-2xl font-medium\">\n          {{ contact.name }}\n        </div>\n      </Tooltip>\n      <div class=\"flex gap-1.5\">\n        <Tooltip :text=\"contact.email_id\">\n          <Button class=\"h-7 w-7\">\n            <EmailIcon class=\"h-4 w-4\" @click=\"openEmailBox()\" />\n          </Button>\n        </Tooltip>\n        <!-- <RouterLink\n          class=\"group cursor-pointer space-x-1 hover:text-gray-900\"\n          :to=\"{\n            name: 'TicketsAgent',\n          }\"\n          target=\"_blank\"\n        >\n          <Button\n            class=\"h-7 w-7\"\n            @click=\"\n              () => {\n                console.log('Show Contact Tickets');\n              }\n            \"\n          >\n            <Tooltip text=\"Show Contact Tickets\">\n              <TicketIcon class=\"h-4 w-4\" />\n            </Tooltip>\n          </Button>\n        </RouterLink> -->\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Tooltip, Avatar } from \"frappe-ui\";\nimport { EmailIcon, TicketIcon } from \"@/components/icons/\";\n\nconst props = defineProps({\n  contact: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst emit = defineEmits([\"email:open\"]);\n\nfunction openEmailBox() {\n  emit(\"email:open\", props.contact.email_id);\n}\n</script>\n","<template>\n  <div\n    class=\"md:mx-8 md:my-4 flex items-center justify-between text-lg font-medium !mx-10 mb-4 !mt-8\"\n  >\n    <div class=\"flex h-8 items-center text-xl font-semibold text-gray-800\">\n      {{ title }}\n    </div>\n    <Button\n      v-if=\"title == 'Emails'\"\n      variant=\"solid\"\n      @click=\"communicationAreaRef.toggleEmailBox()\"\n    >\n      <template #prefix>\n        <FeatherIcon name=\"plus\" class=\"h-4 w-4\" />\n      </template>\n      <span>{{ \"New Email\" }}</span>\n    </Button>\n    <Button\n      v-else-if=\"title == 'Comments'\"\n      variant=\"solid\"\n      @click=\"communicationAreaRef.toggleCommentBox()\"\n    >\n      <template #prefix>\n        <FeatherIcon name=\"plus\" class=\"h-4 w-4\" />\n      </template>\n      <span>{{ \"New Comment\" }}</span>\n    </Button>\n    <Dropdown v-else :options=\"defaultActions\" @click.stop>\n      <template v-slot=\"{ open }\">\n        <Button variant=\"solid\" class=\"flex items-center gap-1\">\n          <template #prefix>\n            <FeatherIcon name=\"plus\" class=\"h-4 w-4\" />\n          </template>\n          <span>{{ \"New\" }}</span>\n          <template #suffix>\n            <FeatherIcon\n              :name=\"open ? 'chevron-up' : 'chevron-down'\"\n              class=\"h-4 w-4\"\n            />\n          </template>\n        </Button>\n      </template>\n    </Dropdown>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { h } from \"vue\";\nimport { computed } from \"vue\";\nimport { EmailIcon, CommentIcon } from \"@/components/icons\";\nimport { Dropdown } from \"frappe-ui\";\nimport { inject } from \"vue\";\nimport { Ref } from \"vue\";\ndefineProps({\n  title: {\n    type: String,\n    required: true,\n  },\n});\n\nconst communicationAreaRef: Ref = inject(\"communicationArea\");\n\nconst defaultActions = computed(() => {\n  let actions = [\n    {\n      icon: h(EmailIcon, { class: \"h-4 w-4\" }),\n      label: \"Email\",\n      onClick: () => communicationAreaRef.value.toggleEmailBox(),\n    },\n    {\n      icon: h(CommentIcon, { class: \"h-4 w-4\" }),\n      label: \"Comment\",\n      onClick: () => communicationAreaRef.value.toggleCommentBox(),\n    },\n  ];\n  return actions;\n});\n</script>\n\n<style scoped></style>\n","<template>\n  <ActivityHeader :title=\"title\" />\n  <FadedScrollableDiv class=\"flex flex-col flex-1 overflow-y-auto\">\n    <div v-if=\"activities.length\" class=\"activities flex-1 h-full mt-1\">\n      <div\n        v-for=\"(activity, i) in activities\"\n        :key=\"activity.key\"\n        class=\"activity\"\n      >\n        <!-- single activity -->\n        <div\n          class=\"w-full px-3 sm:px-10 grid grid-cols-[30px_minmax(auto,_1fr)] gap-2 sm:gap-4\"\n        >\n          <div\n            class=\"relative flex justify-center after:absolute after:left-[50%] after:top-1 after:-z-10 after:border-l after:border-gray-200\"\n            :class=\"[i != activities.length - 1 ? 'after:h-full' : 'after:h-4']\"\n          >\n            <div\n              class=\"z-10 flex h-7 w-7 items-center justify-center rounded-full bg-white\"\n              :class=\"[\n                activity.type === 'comment' ? 'mt-0.5' : '',\n                activity.type === 'history' ? 'mt-1' : '',\n              ]\"\n            >\n              <Avatar\n                v-if=\"activity.type === 'email'\"\n                size=\"md\"\n                :label=\"activity.sender?.full_name\"\n                :image=\"getUser(activity.sender?.name).user_image\"\n                class=\"bg-white\"\n              />\n              <CommentIcon\n                v-else-if=\"activity.type === 'comment'\"\n                class=\"text-gray-800\"\n              />\n              <DotIcon v-else class=\"text-gray-600\" />\n            </div>\n          </div>\n          <div class=\"mb-4 flex flex-1\">\n            <EmailArea\n              v-if=\"activity.type === 'email'\"\n              :activity=\"activity\"\n              :show-split-option=\"\n                !activity.isFirstEmail && ticketStatus !== 'Closed'\n              \"\n              class=\"py-2 px-3\"\n              @reply=\"(e) => emit('email:reply', e)\"\n              @forward=\"(e) => emit('email:forward', e)\"\n            />\n            <CommentBox\n              v-else-if=\"activity.type === 'comment'\"\n              :activity=\"activity\"\n              @update=\"() => emit('update')\"\n            />\n            <HistoryBox v-else :activity=\"activity\" />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      v-else\n      class=\"h-full flex flex-col items-center justify-center gap-3 text-xl font-medium text-gray-500\"\n    >\n      <component :is=\"emptyTextIcon\" class=\"h-10 w-10\" />\n      <span>{{ emptyText }}</span>\n      <Button\n        v-if=\"title == 'Emails'\"\n        label=\"New Email\"\n        @click=\"communicationAreaRef.toggleEmailBox()\"\n      />\n      <Button\n        v-else-if=\"title == 'Comments'\"\n        label=\"New Comment\"\n        @click=\"communicationAreaRef.toggleCommentBox()\"\n      />\n    </div>\n  </FadedScrollableDiv>\n</template>\n\n<script setup lang=\"ts\">\nimport { Ref, inject, h, computed, onMounted, watch, PropType } from \"vue\";\nimport { useElementVisibility } from \"@vueuse/core\";\nimport {\n  DotIcon,\n  EmailAtIcon,\n  CommentIcon,\n  EmailIcon,\n  ActivityIcon,\n} from \"@/components/icons\";\nimport { EmailArea, CommentBox, HistoryBox } from \"@/components\";\nimport { useUserStore } from \"@/stores/user\";\nimport { Avatar } from \"frappe-ui\";\nimport { TicketActivity } from \"@/types\";\nimport { FadedScrollableDiv } from \"@/components\";\nconst props = defineProps({\n  activities: {\n    type: Array as PropType<TicketActivity[]>,\n    required: true,\n  },\n  title: {\n    type: String,\n    required: true,\n  },\n  ticketStatus: {\n    type: String,\n    default: \"\",\n  },\n});\n\nconst emit = defineEmits([\"email:reply\", \"email:forward\", \"update\"]);\n\nconst { getUser } = useUserStore();\nconst communicationAreaRef: Ref = inject(\"communicationArea\");\n\nconst emptyText = computed(() => {\n  let text = \"No Activities\";\n  if (props.title == \"Emails\") {\n    text = \"No Email Communications\";\n  } else if (props.title == \"Comments\") {\n    text = \"No Comments\";\n    return text;\n  }\n});\n\nconst emptyTextIcon = computed(() => {\n  let icon = ActivityIcon;\n  if (props.title == \"Emails\") {\n    icon = EmailIcon;\n  } else if (props.title == \"Comments\") {\n    icon = CommentIcon;\n  }\n  return h(icon, { class: \"text-gray-500\" });\n});\n\nfunction scrollToLatestActivity() {\n  setTimeout(() => {\n    let el;\n    let e = document.getElementsByClassName(\"activity\");\n    el = e[e.length - 1];\n    if (el && !useElementVisibility(el).value) {\n      el.scrollIntoView();\n      el.focus();\n    }\n  }, 500);\n}\n\ndefineExpose({\n  scrollToLatestActivity,\n});\n\nonMounted(() => {\n  scrollToLatestActivity();\n});\n\nwatch(\n  () => props.title,\n  () => {\n    scrollToLatestActivity();\n  }\n);\n</script>\n","<template>\n  <div class=\"flex flex-col gap-3 border-b px-6 py-3\">\n    <div\n      v-for=\"s in sections\"\n      :key=\"s.label\"\n      class=\"flex items-center text-base leading-5\"\n    >\n      <Tooltip :text=\"s.label\">\n        <div class=\"w-[126px] text-sm text-gray-600\">{{ s.label }}</div>\n      </Tooltip>\n      <div class=\"flex items-center justify-between\">\n        <div v-if=\"s.value\">{{ s.value }}</div>\n        <Tooltip :text=\"s.tooltipValue\">\n          <Badge\n            v-if=\"s.badgeText\"\n            class=\"-ml-1\"\n            :label=\"s.badgeText\"\n            variant=\"subtle\"\n            :theme=\"s.badgeColor\"\n          />\n        </Tooltip>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Badge, Tooltip } from \"frappe-ui\";\nimport { dayjs } from \"@/dayjs\";\nimport { formatTime } from \"@/utils\";\nimport { dateFormat, dateTooltipFormat } from \"@/utils\";\nimport { computed } from \"vue\";\n\nconst props = defineProps({\n  ticket: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst firstResponseBadge = computed(() => {\n  let firstResponse = null;\n  if (\n    !props.ticket.first_responded_on &&\n    dayjs().isBefore(dayjs(props.ticket.response_by))\n  ) {\n    firstResponse = {\n      label: `Due in ${formatTime(\n        dayjs(props.ticket.response_by).diff(dayjs(), \"s\")\n      )}`,\n      color: \"orange\",\n    };\n  } else if (\n    dayjs(props.ticket.first_responded_on).isBefore(\n      dayjs(props.ticket.response_by)\n    )\n  ) {\n    firstResponse = {\n      label: `Fulfilled in ${formatTime(\n        dayjs(props.ticket.first_responded_on).diff(\n          dayjs(props.ticket.creation),\n          \"s\"\n        )\n      )}`,\n      color: \"green\",\n    };\n  } else {\n    firstResponse = {\n      label: \"Failed\",\n      color: \"red\",\n    };\n  }\n  return firstResponse;\n});\n\nconst resolutionBadge = computed(() => {\n  let resolution = null;\n  if (\n    props.ticket.status === \"Replied\" &&\n    props.ticket.on_hold_since &&\n    dayjs(props.ticket.resolution_by).isAfter(dayjs(props.ticket.on_hold_since))\n  ) {\n    let time_left = formatTime(\n      dayjs(props.ticket.resolution_by).diff(\n        dayjs(props.ticket.on_hold_since),\n        \"s\"\n      )\n    );\n    resolution = {\n      label: `${time_left} left (On Hold)`,\n      color: \"blue\",\n    };\n  } else if (\n    !props.ticket.resolution_date &&\n    dayjs().isBefore(props.ticket.resolution_by)\n  ) {\n    resolution = {\n      label: `Due in ${formatTime(\n        dayjs(props.ticket.resolution_by).diff(dayjs(), \"s\")\n      )}`,\n      color: \"orange\",\n    };\n  } else if (\n    dayjs(props.ticket.resolution_date).isBefore(props.ticket.resolution_by)\n  ) {\n    resolution = {\n      label: `Fulfilled in ${formatTime(\n        dayjs(props.ticket.resolution_date).diff(\n          dayjs(props.ticket.creation),\n          \"s\"\n        )\n      )}`,\n      color: \"green\",\n    };\n  } else {\n    resolution = {\n      label: \"Failed\",\n      color: \"red\",\n    };\n  }\n  return resolution;\n});\n\nconst sections = computed(() => [\n  {\n    label: \"First Response\",\n    tooltipValue: dateFormat(\n      props.ticket.first_responded_on || props.ticket.response_by,\n      dateTooltipFormat\n    ),\n    badgeText: firstResponseBadge.value.label,\n    badgeColor: firstResponseBadge.value.color,\n  },\n  {\n    label: \"Resolution\",\n    tooltipValue: dateFormat(\n      props.ticket.resolution_date || props.ticket.resolution_by,\n      dateTooltipFormat\n    ),\n    badgeText: resolutionBadge.value.label,\n    badgeColor: resolutionBadge.value.color,\n  },\n  {\n    label: \"Source\",\n    value: props.ticket.via_customer_portal ? \"Portal\" : \"Mail\",\n  },\n]);\n</script>\n","<template>\n  <div class=\"flex gap-2 px-6 pb-1 leading-5 first:mt-3 items-baseline\">\n    <Tooltip :text=\"field.label\">\n      <div class=\"w-[106px] shrink-0 truncate text-sm text-gray-600\">\n        {{ field.label }}\n        <span v-if=\"field.required\" class=\"text-red-500\"> * </span>\n      </div>\n    </Tooltip>\n    <div\n      class=\"-m-0.5 min-h-[28px] flex-1 items-center overflow-hidden p-0.5 text-base\"\n    >\n      <component\n        :is=\"component\"\n        :key=\"field.fieldname\"\n        class=\"form-control\"\n        :placeholder=\"`Add ${field.label}`\"\n        :value=\"transValue\"\n        autocomplete=\"off\"\n        v-on=\"\n          textFields.includes(field.fieldtype)\n            ? {\n                blur: (event) => {\n                  emitUpdate(field.fieldname, event.target.value);\n                },\n              }\n            : {\n                change: (event) => {\n                  emitUpdate(\n                    field.fieldname,\n                    event?.value || event?.target?.value || event\n                  );\n                },\n              }\n        \"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, h } from \"vue\";\nimport { Autocomplete, Link } from \"@/components\";\nimport { createResource, FormControl, Tooltip } from \"frappe-ui\";\nimport { Field, FieldValue } from \"@/types\";\n\ninterface P {\n  field: Field;\n  value: FieldValue;\n}\n\ninterface R {\n  fieldname: Field[\"fieldname\"];\n  value: FieldValue;\n}\n\ninterface E {\n  (event: \"change\", value: R);\n}\n\nconst props = defineProps<P>();\nconst emit = defineEmits<E>();\n\nconst textFields = [\"Long Text\", \"Small Text\", \"Text\", \"Text Editor\"];\n\nconst component = computed(() => {\n  if (props.field.url_method) {\n    return h(Autocomplete, {\n      options: apiOptions.data,\n    });\n  } else if (props.field.fieldtype === \"Link\" && props.field.options) {\n    return h(Link, {\n      doctype: props.field.options,\n      hideMe: true,\n    });\n  } else if (props.field.fieldtype === \"Select\") {\n    return h(Autocomplete, {\n      options: props.field.options\n        .split(\"\\n\")\n        .map((o) => ({ label: o, value: o })),\n    });\n  } else if (props.field.fieldtype === \"Check\") {\n    return h(Autocomplete, {\n      options: [\n        {\n          label: \"Yes\",\n          value: 1,\n        },\n        {\n          label: \"No\",\n          value: 0,\n        },\n      ],\n    });\n  } else if (textFields.includes(props.field.fieldtype)) {\n    return h(FormControl, {\n      type: \"textarea\",\n    });\n  } else {\n    return h(FormControl);\n  }\n});\n\nconst apiOptions = createResource({\n  url: props.field.url_method,\n  auto: !!props.field.url_method,\n  transform: (data) =>\n    data.map((o) => ({\n      label: o,\n      value: o,\n    })),\n});\n\nconst transValue = computed(() => {\n  if (props.field.fieldtype === \"Check\") {\n    return props.value ? \"Yes\" : \"No\";\n  }\n  return props.value;\n});\n\nfunction emitUpdate(fieldname: Field[\"fieldname\"], value: FieldValue) {\n  emit(\"change\", { fieldname, value });\n}\n</script>\n<style scoped>\n:deep(.form-control input:not([type=\"checkbox\"])),\n:deep(.form-control select),\n:deep(.form-control textarea),\n:deep(.form-control button) {\n  border-color: transparent;\n  background: white;\n}\n\n:deep(.form-control button) {\n  gap: 0;\n}\n:deep(.form-control [type=\"checkbox\"]) {\n  margin-left: 9px;\n  cursor: pointer;\n}\n\n:deep(.form-control button > div) {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n:deep(.form-control button svg) {\n  color: white;\n  width: 0;\n}\n</style>\n","<template>\n  <div class=\"flex flex-1 flex-col overflow-hidden overflow-y-auto border-b\">\n    <UniInput2\n      v-for=\"field in fields\"\n      :key=\"field.fieldname\"\n      :field=\"field\"\n      :value=\"ticket[field.fieldname]\"\n      @change=\"(data) => update(data.fieldname, data.value)\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from \"vue\";\nimport UniInput2 from \"../UniInput2.vue\";\nimport { createToast } from \"@/utils\";\nimport { Field, FieldValue } from \"@/types\";\nconst emit = defineEmits([\"update\"]);\n\nconst props = defineProps({\n  ticket: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst fields = computed(() => {\n  return props.ticket.fields;\n});\n\nfunction update(field: Field[\"fieldname\"], value: FieldValue, event = null) {\n  if (field === \"subject\" && value === \"\") {\n    createToast({\n      title: \"Subject is required\",\n      icon: \"x\",\n      iconClasses: \"text-red-600\",\n    });\n    event.target.value = props.ticket.subject;\n    return;\n  }\n  emit(\"update\", { field, value });\n}\n</script>\n<style scoped>\n:deep(.form-control input:not([type=\"checkbox\"])),\n:deep(.form-control select),\n:deep(.form-control textarea),\n:deep(.form-control button) {\n  border-color: transparent;\n  background: white;\n}\n:deep(.form-control textarea) {\n  field-sizing: content;\n}\n\n:deep(.form-control button) {\n  gap: 0;\n}\n:deep(.form-control [type=\"checkbox\"]) {\n  margin-left: 9px;\n  cursor: pointer;\n}\n\n:deep(.form-control button > div) {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n:deep(.form-control button svg) {\n  color: white;\n  width: 0;\n}\n</style>\n"],"names":["d","i","f","m","F","l","o","e","a","r","u","te","s","le","U","C","b","j","G","me","L","E","P","p","v","R","y","t","c","n","k","I","H","h","W","O","N","T","x","w","_","J","A","z","V","M","ee","pe","xe","$","K","B","Z","S","D","g","Y","Q","Ie","ye","X","q","inject","tabRef","ref","indicator","tabsLength","computed","_a","transitionClass","moveIndicator","index","selectedTab","watch","nextTick","onMounted","props","__props","tabIndex","_useModel","provide","_hoisted_1","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","emit","__emit","createListResource","selection","options","result","onUpdateQuery","query","editorRef","showCannedResponseSelectorModal","doc","newEmail","useStorage","attachments","emailEmpty","isContentEmpty","toEmailsClone","ccEmailsClone","bccEmailsClone","showCC","showBCC","cc","bcc","ccInput","bccInput","applyCannedResponse","template","sendMail","createResource","_b","resetState","submitMail","createToast","toggleCC","toggleBCC","removeAttachment","attachment","addToReply","body","toEmails","ccEmails","bccEmails","addToForward","subject","_attachments","handleDiscard","editor","__expose","agentsList","useAgentStore","newComment","commentEmpty","loading","agents","agent","submitComment","values","emails","search","error","text","showOptions","selectedValue","val","addValue","watchDebounced","reload","filterOptions","data","option","email","searchedContacts","value","removeValue","removeLastValue","emailRef","setFocus","content","showEmailBox","showCommentBox","emailEditorRef","commentTextEditorRef","toggleEmailBox","toggleCommentBox","submitEmail","replyToEmail","_c","forwardEmail","showDialog","splitTicket","communication_id","newTicket","handleTicketSplit","sender","to","creation","name","isMobileView","useScreenSize","showSplitModal","authStore","useAuthStore","getUser","useUserStore","commenter","commentedBy","isTicketMergedComment","editable","_content","commentBoxRef","handleEditMode","deleteComment","handleSaveComment","updateComment","user","relatedActivities","show_others","show","addAssignee","removeCurrentAssignee","customFilters","filters","searchInput","templates","filteredTemplates","openEmailBox","communicationAreaRef","defaultActions","EmailIcon","CommentIcon","emptyText","emptyTextIcon","icon","ActivityIcon","scrollToLatestActivity","el","useElementVisibility","firstResponseBadge","firstResponse","dayjs","formatTime","resolutionBadge","resolution","sections","dateFormat","dateTooltipFormat","textFields","component","Autocomplete","apiOptions","Link","FormControl","transValue","emitUpdate","fieldname","fields","update","field","event"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}