import{j as Y,o as a,k as n,l as e,d as M,B as E,al as xe,r as B,h as o,g as r,w as S,H as L,I as V,f as I,t as w,y as b,bu as ae,p as N,aH as ye,e as D,Z as T,W as we,s as j,a2 as X,ac as Z,dJ as Ie,x as z,V as J,ap as Be,U as ee,a as $e,n as Qe,v as W,J as Se,c as Le,q as De,b as Ve,u as Fe,dK as Re,dL as Me,M as U,C as Pe,E as Ue}from"./index-14da1b96.js";import{_ as Je,u as Ze,c as He,j as Ne,C as Te}from"./useView-c256aa2e.js";import{a as je}from"./more-horizontal-4b0bead1.js";import{d as qe}from"./dayjs-1848fb71.js";import{u as oe,c as Ge,a as Oe,_ as ze,b as We,d as O,e as Ye}from"./layoutSettings-80f2aa53.js";import{u as ne,L as Ke}from"./bell-018a0816.js";import{_ as Xe}from"./UserAvatar.vue_vue_type_script_setup_true_lang-c18f002f.js";import"./knowledgeBase-b86a51f6.js";import{_ as et}from"./plus-36546025.js";import{_ as tt}from"./Avatar.vue_vue_type_script_setup_true_lang-31924be6.js";import{F as at}from"./FileUploader-b9a0914f.js";import{g as ot}from"./globalStore-bd2d7230.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-608b497a.js";const nt={},lt={width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function st(d,t){return a(),n("svg",lt,t[0]||(t[0]=[e("rect",{x:"0.75",y:"0.75",width:"30.5",height:"30.5",rx:"6.25",stroke:"currentColor","stroke-width":"1.5"},null,-1),e("path",{d:"M24.5011 14.1124C23.3954 12.4873 21.532 11.5477 19.594 11.6747C18.7616 10.1384 17.2211 9.12267 15.4198 9.0084C14.1651 8.93222 12.8979 9.3766 11.9165 10.24C11.2456 10.8367 10.7611 11.5223 10.463 12.2968C10.289 12.7539 9.89151 13.0459 9.46912 13.0459H6.5V15.5852H9.46912C10.9226 15.5852 12.2271 14.6584 12.7737 13.2237C12.9227 12.8301 13.1712 12.4873 13.5439 12.1571C14.0284 11.7255 14.662 11.4969 15.2583 11.535C16.1528 11.5985 16.7863 12.0175 17.1839 12.538C17.6063 13.0205 17.8423 13.7696 17.979 14.5187C18.774 14.2902 19.6437 14.0997 20.476 14.2394C21.1593 14.3536 21.7929 14.7218 22.2525 15.2678C22.327 15.3567 22.4016 15.4456 22.4637 15.5471C23.06 16.4232 23.1718 17.5024 22.7743 18.5689C22.414 19.5592 21.0847 20.4607 19.9791 20.4607H11.3326C10.1524 20.4607 9.18339 19.5592 9.03432 18.4038H6.54969C6.71119 20.9686 8.78585 23 11.3326 23H19.9915C22.1283 23 24.3769 21.451 25.1098 19.4704C25.7931 17.6167 25.5695 15.6614 24.5135 14.0997L24.5011 14.1124Z",fill:"currentColor"},null,-1)]))}const it=Y(nt,[["render",st]]),ct={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5"},rt={class:"divide-y text-base"},ut={class:"mb-2 leading-5"},dt={class:"space-x-1 text-gray-700"},pt={class:"font-medium text-gray-900"},mt={key:0},gt={key:1},At={key:2},_t={class:"font-medium text-gray-900"},ft={class:"flex items-center gap-2"},ht={class:"text-sm text-gray-600"},Ct={key:0,class:"h-1.5 w-1.5 rounded-full bg-blue-400"},vt=M({__name:"Notifications",setup(d){const t=ne(),l=oe(),i=E(null);xe(i,()=>{t.visible&&t.toggle()},{ignore:["#notifications-btn"]});function s(u){t.toggle(),!u.read&&t.read(u.reference_ticket)}function c(u){switch(u.notification_type){case"Mention":return{name:"TicketAgent",params:{ticketId:u.reference_ticket},hash:"#"+u.reference_comment};case"Assignment":case"Reaction":return{name:"TicketAgent",params:{ticketId:u.reference_ticket}}}}return(u,f)=>{const h=Je,p=B("Button"),x=je,A=B("RouterLink");return o(t).visible?(a(),n("span",{key:0,ref_key:"target",ref:i,class:"fixed z-10 h-screen overflow-auto bg-white",style:ae({"box-shadow":"8px 0px 8px rgba(0, 0, 0, 0.1)","max-width":"350px","min-width":"350px",left:o(l).width})},[e("div",ct,[f[2]||(f[2]=e("span",{class:"text-lg font-medium"},"Notifications",-1)),e("span",null,[r(p,{theme:"blue",variant:"ghost",onClick:f[0]||(f[0]=()=>o(t).clear.submit())},{icon:S(()=>[r(h,{class:"h-4 w-4"})]),_:1}),r(p,{theme:"gray",variant:"ghost",onClick:f[1]||(f[1]=()=>o(t).toggle())},{icon:S(()=>[r(x,{class:"h-4 w-4"})]),_:1})])]),e("div",rt,[(a(!0),n(L,null,V(o(t).data,_=>(a(),I(A,{key:_.name,class:"flex cursor-pointer items-start gap-3.5 px-5 py-2.5 hover:bg-gray-100",to:c(_),onClick:()=>{s(_)}},{default:S(()=>[r(o(Xe),{name:_.user_from},null,8,["name"]),e("span",null,[e("div",ut,[e("span",dt,[e("span",pt,w(_.user_from),1),_.notification_type==="Mention"?(a(),n("span",mt,"mentioned you in ticket")):b("",!0),_.notification_type==="Assignment"?(a(),n("span",gt,"assigned you a ticket")):b("",!0),_.notification_type==="Reaction"?(a(),n("span",At,"has reopened the ticket")):b("",!0),e("span",_t,w(_.reference_ticket),1)])]),e("div",ft,[e("div",ht,w(o(qe).tz(_.creation).fromNow()),1),_.read?b("",!0):(a(),n("div",Ct))])])]),_:2},1032,["to","onClick"]))),128))])],4)):b("",!0)}}}),bt={},kt={class:"flex border-b pr-5"};function Et(d,t){return a(),n("div",kt,t[0]||(t[0]=[e("div",{id:"app-header",class:"flex-1 w-full"},null,-1)]))}const xt=Y(bt,[["render",Et]]);E(!1);E(!1);N({});ye("onboardingStatus",{});E(!1);const yt={},wt={width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function It(d,t){return a(),n("svg",wt,t[0]||(t[0]=[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.2641 1C5.5758 1 4.97583 1.46845 4.80889 2.1362L3.57555 7.06953C3.33887 8.01625 4.05491 8.93333 5.03077 8.93333H7.50682L6.72168 14.4293C6.68838 14.6624 6.82229 14.8872 7.04319 14.9689C7.26408 15.0507 7.51204 14.9671 7.63849 14.7684L13.2161 6.00354C13.6398 5.33782 13.1616 4.46667 12.3725 4.46667H9.59038L10.3017 1.62127C10.3391 1.4719 10.3055 1.31365 10.2108 1.19229C10.116 1.07094 9.97063 1 9.81666 1H6.2641ZM5.77903 2.37873C5.83468 2.15615 6.03467 2 6.2641 2H9.17627L8.46492 4.8454C8.42758 4.99477 8.46114 5.15302 8.55589 5.27437C8.65064 5.39573 8.79602 5.46667 8.94999 5.46667H12.3725L8.0395 12.2757L8.5783 8.50404C8.5988 8.36056 8.55602 8.21523 8.46105 8.10573C8.36608 7.99623 8.22827 7.93333 8.08332 7.93333H5.03077C4.70548 7.93333 4.4668 7.62764 4.5457 7.31207L5.77903 2.37873Z",fill:"currentColor"},null,-1)]))}const te=Y(yt,[["render",It]]),Bt={key:0,class:"flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base"},$t={class:"flex flex-col gap-1"},Qt={class:"inline-flex text-ink-gray-9 gap-2 items-center font-medium"},St="Upgrade to a paid plan for uninterrupted services",Lt={__name:"TrialBanner",props:{isSidebarCollapsed:{type:Boolean,default:!1},afterUpgrade:{type:Function,default:()=>{}}},setup(d){const t=d,l=E(0),i=E(!1),s=E("https://frappecloud.com"),c=E(""),u=D(()=>l.value>1?"Trial ends in "+l.value+" days":"Trial ends tomorrow");T({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"current_site_info_data",auto:!0,onSuccess:p=>{l.value=f(p.trial_end_date),s.value=p.base_url,c.value=p.site_name,i.value=p.setup_complete&&p.plan.is_trial_plan&&l.value>0}});function f(p){if(!p)return 0;p=new Date(p);const A=p-new Date;return Math.ceil(A/(1e3*60*60*24))}function h(){var p;window.open(`${s.value}/dashboard/sites/${c.value}`,"_blank"),(p=t.afterUpgrade)==null||p.call(t)}return(p,x)=>!d.isSidebarCollapsed&&i.value?(a(),n("div",Bt,[e("div",$t,[e("div",Qt,[r(we,{class:"h-4",name:"info"}),j(" "+w(u.value),1)]),e("div",{class:"text-ink-gray-7 text-p-sm"},w(St))]),r(o(X),{label:"Upgrade plan",theme:"blue",onClick:h},{prefix:S(()=>[r(te,{class:"size-4"})]),_:1})])):d.isSidebarCollapsed&&i.value?(a(),I(o(X),{key:1,onClick:h},{default:S(()=>[r(te,{class:"h-4 my-0.5 shrink-0"})]),_:1})):b("",!0)}},Dt={class:"lucide lucide-arrow-left-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Vt(d,t){return a(),n("svg",Dt,t[0]||(t[0]=[e("path",{d:"m9 6-6 6 6 6"},null,-1),e("path",{d:"M3 12h14"},null,-1),e("path",{d:"M21 19V5"},null,-1)]))}const Ft=Z({name:"lucide-arrow-left-from-line",render:Vt}),Rt={class:"lucide lucide-arrow-right-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Mt(d,t){return a(),n("svg",Rt,t[0]||(t[0]=[e("path",{d:"M3 5v14"},null,-1),e("path",{d:"M21 12H7"},null,-1),e("path",{d:"m15 18 6-6-6-6"},null,-1)]))}const Pt=Z({name:"lucide-arrow-right-from-line",render:Mt}),Ut={class:"lucide lucide-mail",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Jt(d,t){return a(),n("svg",Ut,t[0]||(t[0]=[e("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"},null,-1),e("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"},null,-1)]))}const Zt=Z({name:"lucide-mail",render:Jt}),Ht={class:"lucide lucide-image-up",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Nt(d,t){return a(),n("svg",Ht,t[0]||(t[0]=[e("path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"},null,-1),e("path",{d:"m14 19.5 3-3 3 3"},null,-1),e("path",{d:"M17 22v-5.5"},null,-1),e("circle",{cx:"9",cy:"9",r:"2"},null,-1)]))}const Tt=Z({name:"lucide-image-up",render:Nt}),jt={class:"lucide lucide-circle-alert",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function qt(d,t){return a(),n("svg",jt,t[0]||(t[0]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"12",x2:"12",y1:"8",y2:"12"},null,-1),e("line",{x1:"12",x2:"12.01",y1:"16",y2:"16"},null,-1)]))}const le=Z({name:"lucide-circle-alert",render:qt}),se="/assets/helpdesk/desk/assets/gmail-6497f877.png",ie="/assets/helpdesk/desk/assets/outlook-e028ee9b.png",ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwMAAALUBAMAAAClQPMzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAACRQTFRFR3BMNqzpdMXvXb3tr+f3o+P1AJ/ZGoPjALPjmeH1dc3uBqfjM5e/jQAAAAZ0Uk5TAPVwwVLTgnc47wAABIBJREFUeNrt1rEJwlAYhdEHNpZa2UpwAxewcAXtbdJYpQo4gATsBVdwAOcTd/DyknC+9zY4XPhLkSRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJGmGL/cTazo5gOWR69KFWCBAgQIAAAQIECBAgmArBHYEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAMHfO4U6X9tP4reb9aX77/v9rqtH8Ar1bEOl1oWgNsGAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAjqEfShbu9QTajD/AhS8yqzCwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIKheE2p3DFUkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZLG2Bet4fvU2eVggAAAAABJRU5ErkJggg==",re="/assets/helpdesk/desk/assets/sparkpost-3d6653ba.webp",ue="/assets/helpdesk/desk/assets/yahoo-bf2216d3.png",de="/assets/helpdesk/desk/assets/yandex-5e1e6be8.png",pe="/assets/helpdesk/desk/assets/frappe-mail-579163d7.svg",me=[{label:"Account Name",name:"email_account_name",type:"text",placeholder:"Support / Sales"},{label:"Email ID",name:"email_id",type:"email",placeholder:"johndoe@example.com"}],ge=[{label:"Enable Incoming",name:"enable_incoming",type:"checkbox",description:"If enabled, tickets can be created from the incoming emails on this account."},{label:"Enable Outgoing",name:"enable_outgoing",type:"checkbox",description:"If enabled, outgoing emails can be sent from this account."},{label:"Default Incoming",name:"default_incoming",type:"checkbox",description:"If enabled, all replies to your company (eg: replies@yourcomany.com) will come to this account. Note: Only one account can be default incoming."},{label:"Default Outgoing",name:"default_outgoing",type:"checkbox",description:"If enabled, all outgoing emails will be sent from this account. Note: Only one account can be default outgoing."}],Ae=[...me,{label:"Password",name:"password",type:"password",placeholder:"********"}],_e=[...me,{label:"Frappe Mail Site",name:"frappe_mail_site",type:"text",placeholder:"https://frappemail.com"},{label:"API Key",name:"api_key",type:"text",placeholder:"********"},{label:"API Secret",name:"api_secret",type:"password",placeholder:"********"}],fe=[{name:"GMail",icon:se,info:`Setting up GMail requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.google.com/accounts/answer/185833",custom:!1},{name:"Outlook",icon:ie,info:`Setting up Outlook requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.microsoft.com/en-us/account-billing/how-to-get-and-use-app-passwords-5896ed9b-4263-e681-128a-a6f2979a7944",custom:!1},{name:"Sendgrid",icon:ce,info:`Setting up Sendgrid requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://sendgrid.com/docs/ui/account-and-settings/two-factor-authentication/",custom:!1},{name:"SparkPost",icon:re,info:`Setting up SparkPost requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://support.sparkpost.com/docs/my-account-and-profile/enabling-two-factor-authentication",custom:!1},{name:"Yahoo",icon:ue,info:`Setting up Yahoo requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://help.yahoo.com/kb/SLN15241.html",custom:!1},{name:"Yandex",icon:de,info:`Setting up Yandex requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://yandex.com/support/id/authorization/app-passwords.html",custom:!1},{name:"Frappe Mail",icon:pe,info:"Setting up Frappe Mail requires you to have an API key and API Secret of your email account. Read more ",link:"https://github.com/frappe/mail",custom:!0}],he={GMail:se,Outlook:ie,Sendgrid:ce,SparkPost:re,Yahoo:ue,Yandex:de,"Frappe Mail":pe};function Ce(d,t){if(!d.email_account_name)return"Account name is required";if(!d.email_id)return"Email ID is required";if(!Ie(d.email_id))return"Invalid email ID";if(!t&&!d.password)return"Password is required";if(t){if(!d.api_key)return"API Key is required";if(!d.api_secret)return}return""}const Gt=["src"],Ot={key:0,class:"text-center text-xs text-gray-700"},K=M({__name:"EmailProviderIcon",props:{serviceName:{default:""},logo:{default:""},selected:{type:Boolean,default:!1}},setup(d){return(t,l)=>(a(),n(L,null,[e("div",{class:z(["flex h-10 w-10 cursor-pointer items-center justify-center rounded-xl bg-gray-100 hover:bg-gray-200",{"ring-2 ring-blue-500":t.selected}])},[e("img",{src:t.logo,class:"h-6 w-6"},null,8,Gt)],2),t.serviceName?(a(),n("p",Ot,w(t.serviceName),1)):b("",!0)],64))}}),zt={class:"flex h-full flex-col gap-4"},Wt={class:"flex flex-wrap items-center gap-4"},Yt=["onClick"],Kt={key:0,class:"flex flex-col gap-4"},Xt={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},ea={class:"text-wrap text-xs text-gray-700"},ta=["href"],aa={class:"flex flex-col gap-4"},oa={class:"grid grid-cols-1 gap-4"},na={class:"grid grid-cols-2 gap-4"},la={class:"text-gray-500 text-p-sm"},sa={key:1,class:"mt-auto flex justify-between"},ia=M({__name:"EmailAdd",emits:["update:step"],setup(d,{emit:t}){const l=t,i=N({service:"",email_account_name:"",email_id:"",password:"",api_key:"",api_secret:"",frappe_mail_site:"",enable_incoming:!1,enable_outgoing:!1,default_incoming:!1,default_outgoing:!1}),s=E(null),c=D(()=>s.value.custom?_e:Ae);function u(x){s.value=x,i.service=x.name}const f=T({url:"helpdesk.api.settings.create_email_account",makeParams:x=>({...x}),onSuccess:()=>{J({title:"Email account created successfully",icon:"check",iconClasses:"text-green-600"}),l("update:step","email-list")},onError:()=>{h.value="Failed to create email account, Invalid credentials"}}),h=E();function p(){h.value=Ce(i,s.value.custom),!h.value&&f.submit({data:i})}return(x,A)=>{const _=B("FormControl"),F=B("ErrorMessage"),k=B("Button");return a(),n("div",zt,[A[2]||(A[2]=e("div",{role:"heading","aria-level":"1",class:"flex flex-col gap-1"},[e("h5",{class:"text-lg font-semibold"},"Setup Email"),e("p",{class:"text-sm text-gray-600"}," Choose the email service provider you want to configure. ")],-1)),e("div",Wt,[(a(!0),n(L,null,V(o(fe),m=>{var $;return a(),n("div",{key:m.name,class:"min-w-3 mt-4 flex flex-col items-center gap-1",onClick:H=>u(m)},[r(K,{"service-name":m.name,logo:m.icon,selected:(($=s.value)==null?void 0:$.name)===(m==null?void 0:m.name)},null,8,["service-name","logo","selected"])],8,Yt)}),128))]),s.value?(a(),n("div",Kt,[e("div",Xt,[r(o(le),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),e("div",ea,[j(w(s.value.info)+" ",1),e("a",{href:s.value.link,target:"_blank",class:"text-blue-500 underline"},"here",8,ta),A[1]||(A[1]=j(" . "))])]),e("div",aa,[e("div",oa,[(a(!0),n(L,null,V(c.value,m=>(a(),n("div",{key:m.name,class:"flex flex-col gap-1"},[r(_,{modelValue:i[m.name],"onUpdate:modelValue":$=>i[m.name]=$,label:m.label,name:m.name,type:m.type,placeholder:m.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),e("div",na,[(a(!0),n(L,null,V(o(ge),m=>(a(),n("div",{key:m.name,class:"flex flex-col gap-1"},[r(_,{modelValue:i[m.name],"onUpdate:modelValue":$=>i[m.name]=$,label:m.label,name:m.name,type:m.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),e("p",la,w(m.description),1)]))),128))]),h.value?(a(),I(F,{key:0,class:"ml-1",message:h.value},null,8,["message"])):b("",!0)])])):b("",!0),s.value?(a(),n("div",sa,[r(k,{label:"Back",theme:"gray",variant:"outline",disabled:o(f).loading,onClick:A[0]||(A[0]=m=>l("update:step","email-list"))},null,8,["disabled"]),r(k,{label:"Create",variant:"solid",loading:o(f).loading,onClick:p},null,8,["loading"])])):b("",!0)])}}}),ca={class:"flex justify-between items-center border-b border-gray-200 p-2 cursor-pointer"},ra={class:"flex justify-between items-center gap-2"},ua={class:"text-gray-700 font-semibold"},da={class:"text-sm text-gray-500"},pa=M({__name:"EmailAccountCard",props:{emailAccount:{}},setup(d){const t=d,l=D(()=>t.emailAccount.default_incoming&&t.emailAccount.default_outgoing?["Default Sending and Inbox",t.emailAccount.enable_incoming&&t.emailAccount.enable_outgoing?"blue":"gray"]:t.emailAccount.default_incoming?["Default Inbox",t.emailAccount.enable_incoming?"blue":"gray"]:t.emailAccount.default_outgoing?["Default Sending",t.emailAccount.enable_outgoing?"blue":"gray"]:["Inbox",t.emailAccount.enable_incoming?"blue":"gray"]);return(i,s)=>{const c=B("Badge");return a(),n("div",ca,[e("div",ra,[r(K,{logo:o(he)[i.emailAccount.service]},null,8,["logo"]),e("div",null,[e("p",ua,w(i.emailAccount.email_account_name),1),e("div",da,w(i.emailAccount.email_id),1)])]),e("div",null,[r(c,{variant:"subtle",label:l.value[0],theme:l.value[1]},null,8,["label","theme"])])])}}}),ma={class:"flex items-center justify-between"},ga={key:0,class:"mt-4"},Aa={key:1,class:"flex items-center justify-center h-64 text-gray-500"},_a=M({__name:"EmailAccountList",emits:["update:step"],setup(d,{emit:t}){const l=t,i=Be({doctype:"Email Account",cache:!0,fields:["*"],filters:{email_id:["Not Like","%example%"]},pageLength:10,auto:!0,onSuccess:s=>{s.forEach(c=>{c.enable_incoming=!!c.enable_incoming,c.enable_outgoing=!!c.enable_outgoing,c.default_incoming=!!c.default_incoming,c.default_outgoing=!!c.default_outgoing})}});return(s,c)=>{var h;const u=et,f=B("Button");return a(),n("div",null,[e("div",ma,[c[1]||(c[1]=e("h1",{class:"text-lg font-semibold"},"Email Accounts",-1)),r(f,{label:"Add Account",theme:"gray",variant:"solid",onClick:c[0]||(c[0]=p=>l("update:step","email-add"))},{prefix:S(()=>[r(u,{class:"h-4 w-4"})]),_:1})]),!o(i).loading&&((h=o(i).data)!=null&&h.length)?(a(),n("div",ga,[(a(!0),n(L,null,V(o(i).data,p=>(a(),n("div",{key:p.name},[r(pa,{emailAccount:p,onClick:x=>l("update:step","email-edit",p)},null,8,["emailAccount","onClick"])]))),128))])):(a(),n("div",Aa," Please add an email account to continue. "))])}}}),fa={class:"flex h-full flex-col gap-4"},ha={class:"w-fit"},Ca={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},va={class:"text-wrap text-xs text-gray-700"},ba=["href"],ka={class:"flex flex-col gap-4"},Ea={class:"grid grid-cols-1 gap-4"},xa={class:"grid grid-cols-2 gap-4"},ya={class:"text-p-sm text-gray-500"},wa={class:"mt-auto flex justify-between"},Ia=M({__name:"EmailEdit",props:{accountData:{default:null}},emits:["update:step"],setup(d,{emit:t}){var $,H,q,G;const l=d,i=t,s=N({email_account_name:l.accountData.email_account_name||"",service:l.accountData.service||"",email_id:l.accountData.email_id||"",api_key:(($=l.accountData)==null?void 0:$.api_key)||null,api_secret:((H=l.accountData)==null?void 0:H.api_secret)||null,password:((q=l.accountData)==null?void 0:q.password)||null,frappe_mail_site:((G=l.accountData)==null?void 0:G.frappe_mail_site)||"",enable_incoming:l.accountData.enable_incoming||!1,enable_outgoing:l.accountData.enable_outgoing||!1,default_outgoing:l.accountData.default_outgoing||!1,default_incoming:l.accountData.default_incoming||!1}),c={description:"To know more about setting up email accounts, click",link:"https://docs.erpnext.com/docs/user/manual/en/email-account"},u=D(()=>fe.find(C=>C.name===l.accountData.service).custom),f=D(()=>u.value?_e:Ae),h=E(),p=E(!1);async function x(){if(h.value=Ce(s,u.value),h.value)return;const C={...l.accountData},g={...s},R=C.email_account_name!==g.email_account_name;delete C.email_account_name,delete g.email_account_name;const P=A.value,y=g;if(!R&&!P){J({title:"No changes made",icon:"info",iconClasses:"text-blue-600"});return}if(R)try{p.value=!0,await _(),k()}catch{m()}if(P)try{p.value=!0,await F(y),k()}catch{m()}}const A=D(()=>s.email_id!==l.accountData.email_id||s.api_key!==l.accountData.api_key||s.api_secret!==l.accountData.api_secret||s.password!==l.accountData.password||s.enable_incoming!==l.accountData.enable_incoming||s.enable_outgoing!==l.accountData.enable_outgoing||s.default_outgoing!==l.accountData.default_outgoing||s.default_incoming!==l.accountData.default_incoming||s.frappe_mail_site!==l.accountData.frappe_mail_site);async function _(){return await ee("frappe.client.rename_doc",{doctype:"Email Account",old_name:l.accountData.email_account_name,new_name:s.email_account_name})}async function F(C){return(await ee("frappe.client.set_value",{doctype:"Email Account",name:s.email_account_name,fieldname:C})).name}function k(){i("update:step","email-list"),J({title:"Email account updated successfully",icon:"check",iconClasses:"text-green-600"})}function m(){p.value=!1,h.value="Failed to update email account, Invalid credentials"}return(C,g)=>{const R=B("FormControl"),P=B("ErrorMessage"),y=B("Button");return a(),n("div",fa,[g[2]||(g[2]=e("div",{role:"heading","aria-level":"1",class:"flex gap-1 justify-between"},[e("h5",{class:"text-lg font-semibold"},"Edit Email")],-1)),e("div",ha,[r(K,{logo:o(he)[C.accountData.service],"service-name":C.accountData.service},null,8,["logo","service-name"])]),e("div",Ca,[r(o(le),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),e("div",va,[j(w(c.description)+" ",1),e("a",{href:c.link,target:"_blank",class:"text-blue-500 underline"},"here",8,ba),g[1]||(g[1]=j(" . "))])]),e("div",ka,[e("div",Ea,[(a(!0),n(L,null,V(f.value,v=>(a(),n("div",{key:v.name,class:"flex flex-col gap-1"},[r(R,{modelValue:s[v.name],"onUpdate:modelValue":Q=>s[v.name]=Q,label:v.label,name:v.name,type:v.type,placeholder:v.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),e("div",xa,[(a(!0),n(L,null,V(o(ge),v=>(a(),n("div",{key:v.name,class:"flex flex-col gap-1"},[r(R,{modelValue:s[v.name],"onUpdate:modelValue":Q=>s[v.name]=Q,label:v.label,name:v.name,type:v.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),e("p",ya,w(v.description),1)]))),128))]),h.value?(a(),I(P,{key:0,class:"ml-1",message:h.value},null,8,["message"])):b("",!0)]),e("div",wa,[r(y,{label:"Back",theme:"gray",variant:"outline",disabled:p.value,onClick:g[0]||(g[0]=v=>i("update:step","email-list"))},null,8,["disabled"]),r(y,{label:"Update Account",variant:"solid",onClick:x,loading:p.value},null,8,["loading"])])])}}}),Ba={class:"flex-1"},$a={key:0,class:"h-full"},Qa={key:1,class:"h-full"},Sa={key:2,class:"h-full"},La=M({__name:"EmailConfig",setup(d){const t=E("email-list"),l=E(null);function i(s,c){t.value=s,l.value=c}return(s,c)=>(a(),n("div",Ba,[t.value==="email-add"?(a(),n("div",$a,[r(ia,{"onUpdate:step":i})])):t.value==="email-list"?(a(),n("div",Qa,[r(_a,{"onUpdate:step":i})])):t.value==="email-edit"?(a(),n("div",Sa,[r(Ia,{"account-data":l.value,"onUpdate:step":i},null,8,["account-data"])])):b("",!0)]))}}),Da={class:"flex flex-col gap-4"},Va={class:"flex flex-col gap-2"},Fa={class:"text-sm text-gray-600"},Ra={class:"flex gap-4 items-center"},Ma={key:2},Pa=M({__name:"Branding",setup(d){var x;const t=$e(),l=T({url:"frappe.client.get_value",cache:!0,params:{doctype:"Website Settings",fieldname:"favicon"},onSuccess(A){i.brandFavicon=A.favicon},auto:!0}),i=N({brandLogo:t.brandLogo,brandFavicon:((x=l.data)==null?void 0:x.favicon)||""}),s=N({logoLoading:!1,faviconLoading:!1}),c=D(()=>[{title:"Brand Logo",image:i.brandLogo,doctype:"HD Settings",fieldname:"brand_logo",loading:s.logoLoading},{title:"Brand Favicon",image:i.brandFavicon,doctype:"Website Settings",fieldname:"favicon",loading:s.faviconLoading}]),u=T({url:"frappe.client.set_value",debounce:1e3,onSuccess(A){A.doctype==="HD Settings"?h(A.brand_logo):p(A.favicon)},onError(){J({title:"Failed to update, please try again",icon:"x",iconClasses:"text-red-600"}),s.logoLoading=!1,s.faviconLoading=!1}});function f(A,_,F){u.submit({doctype:_,name:_,fieldname:F,value:A}),_==="HD Settings"?s.logoLoading=!0:s.faviconLoading=!0}function h(A){i.brandLogo=A,s.logoLoading=!1,J({title:"Brand Logo Updated",icon:"check",iconClasses:"text-green-600"})}function p(A){i.brandFavicon=A,s.faviconLoading=!1,J({title:"Favicon Updated",text:"Please refresh the page to see the changes",icon:"check",iconClasses:"text-green-600"})}return(A,_)=>{const F=B("Button");return a(),n("div",Da,[_[0]||(_[0]=e("h1",{class:"text-lg font-semibold"},"Customise your Helpdesk",-1)),(a(!0),n(L,null,V(c.value,k=>(a(),n("div",Va,[e("p",Fa,w(k.title),1),e("div",Ra,[k.image&&!k.loading?(a(),I(o(tt),{key:0,size:"3xl",image:k.image},null,8,["image"])):b("",!0),k.image?(a(),n("div",Ma,[r(F,{label:"Remove",onClick:m=>f("",k.doctype,k.fieldname),iconLeft:"trash",loading:k.loading},null,8,["onClick","loading"])])):(a(),I(o(at),{key:1,fileTypes:["image/*"],onSuccess:m=>{f(m.file_url,k.doctype,k.fieldname)}},{default:S(({openFileSelector:m})=>[r(F,{onClick:$=>m(),iconLeft:"upload",label:"Upload Image",loading:k.loading},null,8,["onClick","loading"])]),_:2},1032,["onSuccess"]))])]))),256))])}}}),Ua={class:"flex",style:{height:"calc(100vh - 8rem)"}},Ja={class:"flex w-52 shrink-0 flex-col bg-gray-50 p-2"},Za={class:"mt-3"},Ha=["onClick"],Na={class:"text-base text-gray-800"},Ta={class:"flex flex-1 flex-col overflow-scroll p-4"},ja=M({__name:"SettingsModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(d){let t=[{label:"Email Accounts",icon:Zt,component:La},{label:"Branding",icon:Tt,component:Pa}];const l=Qe(d,"modelValue"),i=E(t[0]);return(s,c)=>(a(),I(o(Se),{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=u=>l.value=u),options:{size:"4xl"}},{body:S(()=>[e("div",Ua,[e("div",Ja,[c[1]||(c[1]=e("h1",{class:"px-2 pt-2 text-lg font-semibold"},"Settings",-1)),e("div",Za,[(a(!0),n(L,null,V(o(t),u=>{var f;return a(),n("button",{key:u.label,class:z(["flex h-7 w-full items-center gap-2 rounded px-2 py-1",[((f=i.value)==null?void 0:f.label)==u.label?"bg-white shadow-sm":"hover:bg-gray-100"]]),onClick:h=>i.value=u},[(a(),I(W(u.icon),{class:"h-4 w-4 text-gray-700"})),e("span",Na,w(u.label),1)],10,Ha)}),128))])]),e("div",Ta,[i.value?(a(),I(W(i.value.component),{key:0})):b("",!0)])])]),_:1},8,["modelValue"]))}}),ve=E("https://frappecloud.com"),be=E(""),qa=T({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"currentSiteInfo",onSuccess:d=>{ve.value=d.base_url,be.value=d.site_name}}),Ga=()=>{const{$dialog:d}=ot();qa.fetch(),d({title:"Login to Frappe Cloud?",message:"Are you sure you want to login to your Frappe Cloud dashboard?",actions:[{label:"Confirm",variant:"solid",onClick(t){Oa(),t()}}]})},Oa=()=>{window.open(`${ve.value}/dashboard/sites/${be.value}`,"_blank")},za={class:"flex items-center gap-0.5 font-medium text-gray-600"},Wa={key:1,class:"mb-4"},Ya={key:0,class:"absolute z-20 h-1.5 w-1.5 translate-x-6 translate-y-1 rounded-full bg-blue-400 left-1",theme:"gray",variant:"solid"},Ka={class:"overflow-y-auto"},Xa={key:0,class:"mx-2 my-2 h-1"},eo=["onClick"],to={class:"flex flex-col"},ao=M({__name:"Sidebar",setup(d){const{isMobileView:t}=Le(),l=De(),i=Ve(),s=Fe(),c=ne(),{isExpanded:u,width:f}=Re(oe()),h=Me(),p=E(!1),{pinnedViews:x,publicViews:A}=Ze(),_=E(window.is_fc_site),F=D(()=>{var R,P;const g=[{label:"All Views",hideLabel:!0,opened:!0,views:U.value?Ge:Oe}];return(R=A.value)!=null&&R.length&&!U.value&&g.push({label:"Public Views",opened:!0,hideLabel:!1,views:k(A.value)}),(P=x.value)!=null&&P.length&&g.push({label:"Private Views",opened:!0,hideLabel:!1,views:k(x.value)}),g});function k(C){return C.map(g=>({label:g.label,icon:g.icon,to:{name:g.route_name,query:{view:g.name}},onClick:()=>{He.value={label:g.label,icon:g.icon}}}))}const m=D(()=>[{label:"Log out",icon:"log-out",onClick:()=>s.logout()}]),$=D(()=>[{component:Z(ze)},{label:"Customer portal",icon:"users",onClick:()=>{const C=i.resolve({name:Pe});window.open(C.href)}},{icon:"life-buoy",label:"Support",onClick:()=>window.open("https://t.me/frappedesk")},{icon:"book-open",label:"Docs",onClick:()=>window.open("https://docs.frappe.io/helpdesk")},{label:"Login to Frappe Cloud",icon:it,onClick:()=>Ga(),condition:()=>!t.value&&window.is_fc_site},{label:"Settings",icon:"settings",onClick:()=>p.value=!0,condition:()=>s.isAdmin||s.isManager},{label:"Log out",icon:"log-out",onClick:()=>s.logout()}]),H=D(()=>U.value?m.value:$.value);function q(C){var g;return l.query.view?l.query.view==((g=C==null?void 0:C.query)==null?void 0:g.view):l.name===C}function G(){window.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}return(C,g)=>{const R=B("Badge"),P=B("FeatherIcon");return a(),n("div",{class:"z-0 flex select-none flex-col border-r border-gray-200 bg-gray-50 p-2 text-base duration-300 ease-in-out",style:ae({"min-width":o(f),"max-width":o(f)})},[r(We,{class:"mb-2 ml-0.5",options:H.value},null,8,["options"]),o(U)?b("",!0):(a(),I(o(O),{key:0,label:"Search",class:"mb-1",icon:o(Ne),"on-click":()=>G(),"is-expanded":o(u)},{right:S(()=>[e("span",za,[(a(),I(W(o(h).modifierIcon),{class:"h-3 w-3"})),g[1]||(g[1]=e("span",null,"K",-1))])]),_:1},8,["icon","on-click","is-expanded"])),o(U)?b("",!0):(a(),n("div",Wa,[o(c).unread?(a(),n("div",Ya)):b("",!0),r(o(O),{class:"relative",label:"Notifications",icon:o(Ke),"on-click":()=>o(c).toggle(),"is-expanded":o(u)},{right:S(()=>[o(u)&&o(c).unread?(a(),I(R,{key:0,label:o(c).unread>9?"9+":o(c).unread,theme:"gray",variant:"subtle"},null,8,["label"])):b("",!0)]),_:1},8,["icon","on-click","is-expanded"])])),e("div",Ka,[(a(!0),n(L,null,V(F.value,y=>{var v;return a(),n("div",{key:y.label},[!y.hideLabel&&!o(u)&&((v=y.views)!=null&&v.length)?(a(),n("div",Xa)):b("",!0),r(o(Ye),{label:y.label,hideLabel:y.hideLabel,opened:y.opened},{header:S(({opened:Q,hide:ke,toggle:Ee})=>[ke?b("",!0):(a(),n("div",{key:0,class:z(["flex cursor-pointer gap-1.5 px-1 text-base font-medium text-ink-gray-5 transition-all duration-300 ease-in-out",o(u)?"mt-4 h-7 w-auto opacity-100":"ml-0 h-0 overflow-hidden opacity-0"]),onClick:lo=>Ee()},[r(P,{name:"chevron-right",class:z(["h-4 text-ink-gray-9 transition-all duration-300 ease-in-out",{"rotate-90":Q}])},null,8,["class"]),e("span",null,w(y.label),1)],10,eo))]),default:S(()=>[e("nav",to,[(a(!0),n(L,null,V(y.views,Q=>(a(),I(o(O),{icon:Q.icon,label:Q.label,to:Q.to,key:Q.label,"is-expanded":o(u),"is-active":q(Q.to),class:"my-0.5 emoji",onClick:Q.onClick},null,8,["icon","label","to","is-expanded","is-active","onClick"]))),128))])]),_:2},1032,["label","hideLabel","opened"])])}),128))]),g[2]||(g[2]=e("div",{class:"grow"},null,-1)),_.value&&!o(U)?(a(),I(o(Lt),{key:2,isSidebarCollapsed:!o(u)},null,8,["isSidebarCollapsed"])):b("",!0),r(o(O),{icon:o(u)?o(Ft):o(Pt),"is-active":!1,"is-expanded":o(u),label:o(u)?"Collapse":"Expand","on-click":()=>u.value=!o(u)},null,8,["icon","is-expanded","label","on-click"]),r(ja,{modelValue:p.value,"onUpdate:modelValue":g[0]||(g[0]=y=>p.value=y)},null,8,["modelValue"])],4)}}}),oo={class:"flex h-screen w-screen"},no={class:"flex-1 flex flex-col h-full overflow-auto"},vo={__name:"DesktopLayout",setup(d){return(t,l)=>(a(),n("div",oo,[r(ao),e("div",no,[r(xt),Ue(t.$slots,"default")]),r(o(vt)),r(o(Te))]))}};export{vo as default};
//# sourceMappingURL=DesktopLayout-aa9ed331.js.map
