import{e as h,r as g,o as i,k as u,H as m,I as v,f as k,ae as A,w as f,g as _,y as b,h as y}from"./index-7cfac70d.js";import{_ as C}from"./Dropdown.vue_vue_type_script_setup_true_lang-78ec013f.js";const L={key:0,class:"flex gap-2"},j={key:2},E={__name:"CustomActions",props:{actions:{type:Object,required:!0}},setup(e){const o=e,n=h(()=>o.actions.filter(r=>!r.group)),t=h(()=>{let r=[];return o.actions.filter(a=>a.buttonLabel&&a.group).forEach(a=>{let c=r.findIndex(p=>p.label===a.buttonLabel);c>-1?r[c].action.push(a):r.push({label:a.buttonLabel,action:[a]})}),r}),s=h(()=>{let r=[];return r=r.concat(o.actions.filter(a=>a.group&&!a.buttonLabel)),r});return(r,a)=>{const c=g("FeatherIcon"),p=g("Button");return i(),u(m,null,[n.value.length?(i(),u("div",L,[(i(!0),u(m,null,v(n.value,l=>(i(),k(p,{key:l.label,label:l.label,onClick:d=>l.onClick()},A({_:2},[l.icon?{name:"prefix",fn:f(()=>[_(c,{name:l.icon,class:"h-4 w-4"},null,8,["name"])]),key:"0"}:void 0]),1032,["label","onClick"]))),128))])):b("",!0),s.value.length?(i(),k(y(C),{key:1,options:s.value},{default:f(()=>[_(p,{icon:"more-horizontal"})]),_:1},8,["options"])):b("",!0),t.value.length?(i(),u("div",j,[(i(!0),u(m,null,v(t.value,l=>(i(),u("div",{key:l.label},[_(y(C),{options:l.action},{default:f(({open:d})=>[_(p,{label:l.label},{suffix:f(()=>[_(c,{name:d?"chevron-up":"chevron-down",class:"h-4"},null,8,["name"])]),_:2},1032,["label"])]),_:2},1032,["options"])]))),128))])):b("",!0)],64)}}};function N(e,o){if(!e._form_script)return[];let n=[],t={};if(Array.isArray(e._form_script))e._form_script.forEach(s=>{const r=O(s,o);n=n.concat(r.actions),r.onChange&&F(t,r.onChange)});else{const s=O(e._form_script,o);n=s.actions,s.onChange&&F(t,s.onChange)}e._customActions=n,Object.keys(t).length&&(e._customOnChange=t)}function F(e,o){for(const[n,t]of Object.entries(o))e[n]||(e[n]=new Set),e[n].add(t)}function O(e,o){const t=new Function(e+`
return setupForm`)()(o);return{actions:(t==null?void 0:t.actions)||[],onChange:(t==null?void 0:t.onChange)||null}}function q(e,o,n,t,s){n?e.options=n.join(`
`):e.options=s.find(r=>r.fieldname===o).options,t[o]=""}function S(e,o,n,t,s){if(!n){e.link_filters=s.find(r=>r.fieldname===o).link_filters;return}e.link_filters=JSON.stringify([[e.options,"name","in",n]]),t[o]=""}function V(e,o){return{display_via_depends_on:w(e==null?void 0:e.depends_on,o),...e,required:e.required||e.mandatory_depends_on&&w(e.mandatory_depends_on,o),filters:e.link_filters&&JSON.parse(e.link_filters)}}function w(e,o){if(!e)return!0;let n=null;if(e.substr(0,5)=="eval:")try{n=x(e.substr(5),{doc:o})}catch{n=!0}else if(e.substr(0,4)=="doc.")n=o[e.substr(4)];else{let t=o[e];Array.isArray(t)?n=!!t.length:n=!!t}return n}function x(e,o={}){let n=Object.keys(o),t=Object.values(o);e=`let out = ${e}; return out`;try{return new Function(...n,e)(...t)}catch(s){throw console.log("Error evaluating the following expression:"),console.error(e),s}}export{E as _,S as a,q as h,V as p,N as s};
//# sourceMappingURL=formCustomisation-1cf8df92.js.map
